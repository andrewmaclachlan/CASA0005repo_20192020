<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Introduction to R | CASA0005 Geographic Information Systems and Science</title>
  <meta name="description" content="Chapter 2 Introduction to R | CASA0005 Geographic Information Systems and Science" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Introduction to R | CASA0005 Geographic Information Systems and Science" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Introduction to R | CASA0005 Geographic Information Systems and Science" />
  
  
  

<meta name="author" content="Andy MacLachlan and Adam Dennett" />


<meta name="date" content="2020-02-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="geographic-information.html"/>
<link rel="next" href="rasters-descriptive-statistics-and-interpolation.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>
<script async defer src="https://hypothes.is/embed.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-151934476-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-151934476-1');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">CASA0005</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-world-of-gis"><i class="fa fa-check"></i>The world of GIS</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#getting-started"><i class="fa fa-check"></i>Getting started</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-dowload-data-and-files-from-github"><i class="fa fa-check"></i>How to dowload data and files from GitHub</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#option-1"><i class="fa fa-check"></i>Option 1</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#option-2"><i class="fa fa-check"></i>Option 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#self-guided-learning"><i class="fa fa-check"></i>Self guided learning</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#interactive-lectures"><i class="fa fa-check"></i>Interactive lectures</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#more-help"><i class="fa fa-check"></i>More help</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#noticed-a-mistake"><i class="fa fa-check"></i>Noticed a mistake?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#assignment-resources"><i class="fa fa-check"></i>Assignment resources</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#reading-list"><i class="fa fa-check"></i>Reading list</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="geographic-information.html"><a href="geographic-information.html"><i class="fa fa-check"></i><b>1</b> Geographic Information</a><ul>
<li class="chapter" data-level="1.1" data-path="geographic-information.html"><a href="geographic-information.html#learning-outcomes"><i class="fa fa-check"></i><b>1.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="1.2" data-path="geographic-information.html"><a href="geographic-information.html#recommended-listening"><i class="fa fa-check"></i><b>1.2</b> Recommended listening</a></li>
<li class="chapter" data-level="1.3" data-path="geographic-information.html"><a href="geographic-information.html#the-basics-of-geographic-information"><i class="fa fa-check"></i><b>1.3</b> The Basics of Geographic Information</a><ul>
<li class="chapter" data-level="1.3.1" data-path="geographic-information.html"><a href="geographic-information.html#important-gis-data-formats"><i class="fa fa-check"></i><b>1.3.1</b> Important GIS data formats</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="geographic-information.html"><a href="geographic-information.html#data"><i class="fa fa-check"></i><b>1.4</b> Data</a><ul>
<li class="chapter" data-level="1.4.1" data-path="geographic-information.html"><a href="geographic-information.html#file-paths"><i class="fa fa-check"></i><b>1.4.1</b> File paths</a></li>
<li class="chapter" data-level="1.4.2" data-path="geographic-information.html"><a href="geographic-information.html#data-download"><i class="fa fa-check"></i><b>1.4.2</b> Data download</a></li>
<li class="chapter" data-level="1.4.3" data-path="geographic-information.html"><a href="geographic-information.html#data-pre-processing"><i class="fa fa-check"></i><b>1.4.3</b> Data pre-processing</a></li>
<li class="chapter" data-level="1.4.4" data-path="geographic-information.html"><a href="geographic-information.html#data-loading"><i class="fa fa-check"></i><b>1.4.4</b> Data loading</a></li>
<li class="chapter" data-level="1.4.5" data-path="geographic-information.html"><a href="geographic-information.html#arcgis"><i class="fa fa-check"></i><b>1.4.5</b> ArcGIS</a></li>
<li class="chapter" data-level="1.4.6" data-path="geographic-information.html"><a href="geographic-information.html#qgis"><i class="fa fa-check"></i><b>1.4.6</b> QGIS</a></li>
<li class="chapter" data-level="1.4.7" data-path="geographic-information.html"><a href="geographic-information.html#r"><i class="fa fa-check"></i><b>1.4.7</b> R</a></li>
<li class="chapter" data-level="1.4.8" data-path="geographic-information.html"><a href="geographic-information.html#export-data-2"><i class="fa fa-check"></i><b>1.4.8</b> Export data</a></li>
<li class="chapter" data-level="1.4.9" data-path="geographic-information.html"><a href="geographic-information.html#what-will-i-use-1"><i class="fa fa-check"></i><b>1.4.9</b> What will I use</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="geographic-information.html"><a href="geographic-information.html#data-sources-and-task"><i class="fa fa-check"></i><b>1.5</b> Data sources and task</a><ul>
<li class="chapter" data-level="1.5.1" data-path="geographic-information.html"><a href="geographic-information.html#uk-data-service"><i class="fa fa-check"></i><b>1.5.1</b> UK Data Service</a></li>
<li class="chapter" data-level="1.5.2" data-path="geographic-information.html"><a href="geographic-information.html#ons"><i class="fa fa-check"></i><b>1.5.2</b> ONS</a></li>
<li class="chapter" data-level="1.5.3" data-path="geographic-information.html"><a href="geographic-information.html#nomis"><i class="fa fa-check"></i><b>1.5.3</b> nomis</a></li>
<li class="chapter" data-level="1.5.4" data-path="geographic-information.html"><a href="geographic-information.html#os"><i class="fa fa-check"></i><b>1.5.4</b> OS</a></li>
<li class="chapter" data-level="1.5.5" data-path="geographic-information.html"><a href="geographic-information.html#edina-digimap"><i class="fa fa-check"></i><b>1.5.5</b> Edina Digimap</a></li>
<li class="chapter" data-level="1.5.6" data-path="geographic-information.html"><a href="geographic-information.html#osm"><i class="fa fa-check"></i><b>1.5.6</b> OSM</a></li>
<li class="chapter" data-level="1.5.7" data-path="geographic-information.html"><a href="geographic-information.html#defra"><i class="fa fa-check"></i><b>1.5.7</b> DEFRA</a></li>
<li class="chapter" data-level="1.5.8" data-path="geographic-information.html"><a href="geographic-information.html#data-lists"><i class="fa fa-check"></i><b>1.5.8</b> Data lists</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="geographic-information.html"><a href="geographic-information.html#summary"><i class="fa fa-check"></i><b>1.6</b> Summary</a></li>
<li class="chapter" data-level="1.7" data-path="geographic-information.html"><a href="geographic-information.html#feedback"><i class="fa fa-check"></i><b>1.7</b> Feedback</a></li>
<li class="chapter" data-level="1.8" data-path="geographic-information.html"><a href="geographic-information.html#mac-r-issues"><i class="fa fa-check"></i><b>1.8</b> Mac R issues</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#learning-outcomes-1"><i class="fa fa-check"></i><b>2.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#recommended-listening-1"><i class="fa fa-check"></i><b>2.2</b> Recommended listening</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#introduction-3"><i class="fa fa-check"></i><b>2.3</b> Introduction</a><ul>
<li class="chapter" data-level="2.3.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#online-forums-are-your-friend"><i class="fa fa-check"></i><b>2.3.1</b> Online forums are your friend!!</a></li>
<li class="chapter" data-level="2.3.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#health-warning"><i class="fa fa-check"></i><b>2.3.2</b> Health warning</a></li>
<li class="chapter" data-level="2.3.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.3.3</b> R and RStudio</a></li>
<li class="chapter" data-level="2.3.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#getting-started-1"><i class="fa fa-check"></i><b>2.3.4</b> Getting started</a></li>
<li class="chapter" data-level="2.3.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#basics-1"><i class="fa fa-check"></i><b>2.3.5</b> Basics</a></li>
<li class="chapter" data-level="2.3.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#scripts-and-some-basic-commands"><i class="fa fa-check"></i><b>2.3.6</b> Scripts and some basic commands</a></li>
<li class="chapter" data-level="2.3.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#functions"><i class="fa fa-check"></i><b>2.3.7</b> Functions</a></li>
<li class="chapter" data-level="2.3.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#basic-plotting"><i class="fa fa-check"></i><b>2.3.8</b> Basic plotting</a></li>
<li class="chapter" data-level="2.3.9" data-path="introduction-to-r.html"><a href="introduction-to-r.html#help"><i class="fa fa-check"></i><b>2.3.9</b> Help</a></li>
<li class="chapter" data-level="2.3.10" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-types"><i class="fa fa-check"></i><b>2.3.10</b> Data types</a></li>
<li class="chapter" data-level="2.3.11" data-path="introduction-to-r.html"><a href="introduction-to-r.html#elements-of-a-data-frame"><i class="fa fa-check"></i><b>2.3.11</b> Elements of a data frame</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#reading-data-into-r"><i class="fa fa-check"></i><b>2.4</b> Reading data into R</a><ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#old-skool-cleaning"><i class="fa fa-check"></i><b>2.4.1</b> Old skool cleaning</a></li>
<li class="chapter" data-level="2.4.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#new-skool-cleaning"><i class="fa fa-check"></i><b>2.4.2</b> New skool cleaning</a></li>
<li class="chapter" data-level="2.4.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#examining-your-new-data"><i class="fa fa-check"></i><b>2.4.3</b> Examining your new data</a></li>
<li class="chapter" data-level="2.4.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-manipulation-in-r"><i class="fa fa-check"></i><b>2.4.4</b> Data manipulation in R</a></li>
<li class="chapter" data-level="2.4.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#plotting"><i class="fa fa-check"></i><b>2.4.5</b> Plotting</a></li>
<li class="chapter" data-level="2.4.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#pimp-my-graph"><i class="fa fa-check"></i><b>2.4.6</b> Pimp my graph!</a></li>
<li class="chapter" data-level="2.4.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#spatial-data-in-r"><i class="fa fa-check"></i><b>2.4.7</b> Spatial Data in R</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#making-maps-using-ggplot2"><i class="fa fa-check"></i><b>2.5</b> Making maps using ggplot2</a><ul>
<li class="chapter" data-level="2.5.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#changing-projections"><i class="fa fa-check"></i><b>2.5.1</b> Changing projections</a></li>
<li class="chapter" data-level="2.5.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#maps-with-extra-features"><i class="fa fa-check"></i><b>2.5.2</b> Maps with extra features</a></li>
<li class="chapter" data-level="2.5.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#extension"><i class="fa fa-check"></i><b>2.5.3</b> Extension</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#writing-good-r-code"><i class="fa fa-check"></i><b>2.6</b> Writing good R code</a></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#tidying-data"><i class="fa fa-check"></i><b>2.7</b> Tidying data</a></li>
<li class="chapter" data-level="2.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#feedback-1"><i class="fa fa-check"></i><b>2.8</b> Feedback</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html"><i class="fa fa-check"></i><b>3</b> Rasters, descriptive statistics and interpolation</a><ul>
<li class="chapter" data-level="3.1" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#learning-outcomes-2"><i class="fa fa-check"></i><b>3.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="3.2" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#recommended-listening-2"><i class="fa fa-check"></i><b>3.2</b> Recommended listening</a></li>
<li class="chapter" data-level="3.3" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#introduction-4"><i class="fa fa-check"></i><b>3.3</b> Introduction</a></li>
<li class="chapter" data-level="3.4" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#part-1-rasters"><i class="fa fa-check"></i><b>3.4</b> Part 1 rasters</a><ul>
<li class="chapter" data-level="3.4.1" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#worldclim-data"><i class="fa fa-check"></i><b>3.4.1</b> WorldClim data</a></li>
<li class="chapter" data-level="3.4.2" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#location-data-from-a-raster"><i class="fa fa-check"></i><b>3.4.2</b> Location data from a raster</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#part-2-descriptive-statistics"><i class="fa fa-check"></i><b>3.5</b> Part 2 descriptive statistics</a><ul>
<li class="chapter" data-level="3.5.1" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#data-preparation"><i class="fa fa-check"></i><b>3.5.1</b> Data preparation</a></li>
<li class="chapter" data-level="3.5.2" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#histogram"><i class="fa fa-check"></i><b>3.5.2</b> Histogram</a></li>
<li class="chapter" data-level="3.5.3" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#using-more-data"><i class="fa fa-check"></i><b>3.5.3</b> Using more data</a></li>
<li class="chapter" data-level="3.5.4" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#histogram-with-ggplot"><i class="fa fa-check"></i><b>3.5.4</b> Histogram with ggplot</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#part-3-interpolation"><i class="fa fa-check"></i><b>3.6</b> Part 3 interpolation</a></li>
<li class="chapter" data-level="3.7" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#auto-data-download"><i class="fa fa-check"></i><b>3.7</b> Auto data download</a></li>
<li class="chapter" data-level="3.8" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#advanced-analysis"><i class="fa fa-check"></i><b>3.8</b> Advanced analysis</a></li>
<li class="chapter" data-level="3.9" data-path="rasters-descriptive-statistics-and-interpolation.html"><a href="rasters-descriptive-statistics-and-interpolation.html#feedback-2"><i class="fa fa-check"></i><b>3.9</b> Feedback</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html"><i class="fa fa-check"></i><b>4</b> Git, GitHub and RMarkdown</a><ul>
<li class="chapter" data-level="4.1" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#learning-outcomes-3"><i class="fa fa-check"></i><b>4.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="4.2" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#recommended-listening-3"><i class="fa fa-check"></i><b>4.2</b> Recommended listening</a></li>
<li class="chapter" data-level="4.3" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#introduction-5"><i class="fa fa-check"></i><b>4.3</b> Introduction</a></li>
<li class="chapter" data-level="4.4" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#the-three-ways"><i class="fa fa-check"></i><b>4.4</b> The three ways</a></li>
<li class="chapter" data-level="4.5" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#set-up-your-github"><i class="fa fa-check"></i><b>4.5</b> Set up your GitHub</a></li>
<li class="chapter" data-level="4.6" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#using-rstudio-with-git"><i class="fa fa-check"></i><b>4.6</b> Using RStudio with Git</a></li>
<li class="chapter" data-level="4.7" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#using-the-git-gui---way-1"><i class="fa fa-check"></i><b>4.7</b> Using the Git GUI - way 1</a></li>
<li class="chapter" data-level="4.8" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#create-a-new-version-control-in-rstudio---way-2"><i class="fa fa-check"></i><b>4.8</b> Create a new version control in RStudio - way 2</a></li>
<li class="chapter" data-level="4.9" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#if-have-have-an-existing-project---way-3"><i class="fa fa-check"></i><b>4.9</b> If have have an existing project - way 3</a></li>
<li class="chapter" data-level="4.10" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#commiting-to-git"><i class="fa fa-check"></i><b>4.10</b> Commiting to Git</a></li>
<li class="chapter" data-level="4.11" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#using-git-outside-rstudio"><i class="fa fa-check"></i><b>4.11</b> Using Git outside RStudio</a></li>
<li class="chapter" data-level="4.12" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#push-to-github"><i class="fa fa-check"></i><b>4.12</b> Push to Github</a></li>
<li class="chapter" data-level="4.13" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#pull-from-github"><i class="fa fa-check"></i><b>4.13</b> Pull from GitHub</a></li>
<li class="chapter" data-level="4.14" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#troubleshooting"><i class="fa fa-check"></i><b>4.14</b> Troubleshooting</a><ul>
<li class="chapter" data-level="4.14.1" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#were-you-challenged-for-your-password"><i class="fa fa-check"></i><b>4.14.1</b> Were you challenged for your password?</a></li>
<li class="chapter" data-level="4.14.2" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#greyed-out-push-button"><i class="fa fa-check"></i><b>4.14.2</b> Greyed out push button</a></li>
</ul></li>
<li class="chapter" data-level="4.15" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#fork-a-repository"><i class="fa fa-check"></i><b>4.15</b> Fork a repository</a></li>
<li class="chapter" data-level="4.16" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#branches"><i class="fa fa-check"></i><b>4.16</b> Branches</a></li>
<li class="chapter" data-level="4.17" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#back-in-time"><i class="fa fa-check"></i><b>4.17</b> Back in time</a></li>
<li class="chapter" data-level="4.18" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#health-warning-1"><i class="fa fa-check"></i><b>4.18</b> Health warning</a></li>
<li class="chapter" data-level="4.19" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#rmarkdown"><i class="fa fa-check"></i><b>4.19</b> RMarkdown</a><ul>
<li class="chapter" data-level="4.19.1" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#html"><i class="fa fa-check"></i><b>4.19.1</b> HTML</a></li>
<li class="chapter" data-level="4.19.2" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#flexdashboard"><i class="fa fa-check"></i><b>4.19.2</b> Flexdashboard</a></li>
<li class="chapter" data-level="4.19.3" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#word-document"><i class="fa fa-check"></i><b>4.19.3</b> Word document</a></li>
<li class="chapter" data-level="4.19.4" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#knit-options"><i class="fa fa-check"></i><b>4.19.4</b> Knit options</a></li>
</ul></li>
<li class="chapter" data-level="4.20" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#adding-references"><i class="fa fa-check"></i><b>4.20</b> Adding references</a><ul>
<li class="chapter" data-level="4.20.1" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#set-up-mendeley"><i class="fa fa-check"></i><b>4.20.1</b> Set up Mendeley</a></li>
<li class="chapter" data-level="4.20.2" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#add-refereces-into-r"><i class="fa fa-check"></i><b>4.20.2</b> Add refereces into R</a></li>
<li class="chapter" data-level="4.20.3" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#references-using-citr"><i class="fa fa-check"></i><b>4.20.3</b> References using <code>citr</code></a></li>
<li class="chapter" data-level="4.20.4" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#yaml-options"><i class="fa fa-check"></i><b>4.20.4</b> YAML options</a></li>
<li class="chapter" data-level="4.20.5" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#packrat"><i class="fa fa-check"></i><b>4.20.5</b> Packrat</a></li>
</ul></li>
<li class="chapter" data-level="4.21" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#binder"><i class="fa fa-check"></i><b>4.21</b> Binder</a></li>
<li class="chapter" data-level="4.22" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#further-reading"><i class="fa fa-check"></i><b>4.22</b> Further reading</a></li>
<li class="chapter" data-level="4.23" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#feedback-3"><i class="fa fa-check"></i><b>4.23</b> Feedback</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="map-making.html"><a href="map-making.html"><i class="fa fa-check"></i><b>5</b> Map making</a><ul>
<li class="chapter" data-level="5.1" data-path="map-making.html"><a href="map-making.html#learning-outcomes-4"><i class="fa fa-check"></i><b>5.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="5.2" data-path="map-making.html"><a href="map-making.html#recommended-listening-4"><i class="fa fa-check"></i><b>5.2</b> Recommended listening</a></li>
<li class="chapter" data-level="5.3" data-path="map-making.html"><a href="map-making.html#introduction-6"><i class="fa fa-check"></i><b>5.3</b> Introduction</a><ul>
<li class="chapter" data-level="5.3.1" data-path="map-making.html"><a href="map-making.html#osm-1"><i class="fa fa-check"></i><b>5.3.1</b> OSM</a></li>
<li class="chapter" data-level="5.3.2" data-path="map-making.html"><a href="map-making.html#airbnb"><i class="fa fa-check"></i><b>5.3.2</b> Airbnb</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="map-making.html"><a href="map-making.html#data-1"><i class="fa fa-check"></i><b>5.4</b> Data</a><ul>
<li class="chapter" data-level="5.4.1" data-path="map-making.html"><a href="map-making.html#osm-2"><i class="fa fa-check"></i><b>5.4.1</b> OSM</a></li>
<li class="chapter" data-level="5.4.2" data-path="map-making.html"><a href="map-making.html#london-boroughs"><i class="fa fa-check"></i><b>5.4.2</b> London boroughs</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="map-making.html"><a href="map-making.html#mapping-in-arcmap"><i class="fa fa-check"></i><b>5.5</b> Mapping in ArcMap</a><ul>
<li class="chapter" data-level="5.5.1" data-path="map-making.html"><a href="map-making.html#load-data-3"><i class="fa fa-check"></i><b>5.5.1</b> Load data</a></li>
<li class="chapter" data-level="5.5.2" data-path="map-making.html"><a href="map-making.html#manipulate-data"><i class="fa fa-check"></i><b>5.5.2</b> Manipulate data</a></li>
<li class="chapter" data-level="5.5.3" data-path="map-making.html"><a href="map-making.html#map-data"><i class="fa fa-check"></i><b>5.5.3</b> Map data</a></li>
<li class="chapter" data-level="5.5.4" data-path="map-making.html"><a href="map-making.html#export-map"><i class="fa fa-check"></i><b>5.5.4</b> Export map</a></li>
<li class="chapter" data-level="5.5.5" data-path="map-making.html"><a href="map-making.html#model-builder"><i class="fa fa-check"></i><b>5.5.5</b> Model builder</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="map-making.html"><a href="map-making.html#qgis-1"><i class="fa fa-check"></i><b>5.6</b> QGIS</a><ul>
<li class="chapter" data-level="5.6.1" data-path="map-making.html"><a href="map-making.html#load-data-4"><i class="fa fa-check"></i><b>5.6.1</b> Load data</a></li>
<li class="chapter" data-level="5.6.2" data-path="map-making.html"><a href="map-making.html#manipulate-data-1"><i class="fa fa-check"></i><b>5.6.2</b> Manipulate data</a></li>
<li class="chapter" data-level="5.6.3" data-path="map-making.html"><a href="map-making.html#map-data-1"><i class="fa fa-check"></i><b>5.6.3</b> Map data</a></li>
<li class="chapter" data-level="5.6.4" data-path="map-making.html"><a href="map-making.html#export-map-1"><i class="fa fa-check"></i><b>5.6.4</b> Export map</a></li>
<li class="chapter" data-level="5.6.5" data-path="map-making.html"><a href="map-making.html#graphical-modeler"><i class="fa fa-check"></i><b>5.6.5</b> Graphical modeler</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="map-making.html"><a href="map-making.html#r-1"><i class="fa fa-check"></i><b>5.7</b> R</a><ul>
<li class="chapter" data-level="5.7.1" data-path="map-making.html"><a href="map-making.html#static-map"><i class="fa fa-check"></i><b>5.7.1</b> Static map</a></li>
<li class="chapter" data-level="5.7.2" data-path="map-making.html"><a href="map-making.html#export"><i class="fa fa-check"></i><b>5.7.2</b> Export</a></li>
<li class="chapter" data-level="5.7.3" data-path="map-making.html"><a href="map-making.html#basic-interactive-map"><i class="fa fa-check"></i><b>5.7.3</b> Basic interactive map</a></li>
<li class="chapter" data-level="5.7.4" data-path="map-making.html"><a href="map-making.html#advanced-interactive-map"><i class="fa fa-check"></i><b>5.7.4</b> Advanced interactive map</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="map-making.html"><a href="map-making.html#bad-maps"><i class="fa fa-check"></i><b>5.8</b> Bad maps</a></li>
<li class="chapter" data-level="5.9" data-path="map-making.html"><a href="map-making.html#feedback-4"><i class="fa fa-check"></i><b>5.9</b> Feedback</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html"><i class="fa fa-check"></i><b>6</b> Analysing spatial patterns</a><ul>
<li class="chapter" data-level="6.1" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#learning-outcomes-5"><i class="fa fa-check"></i><b>6.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="6.2" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#recommended-listening-5"><i class="fa fa-check"></i><b>6.2</b> Recommended listening</a></li>
<li class="chapter" data-level="6.3" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#introduction-7"><i class="fa fa-check"></i><b>6.3</b> Introduction</a></li>
<li class="chapter" data-level="6.4" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#setting-up-your-data"><i class="fa fa-check"></i><b>6.4</b> Setting up your data</a><ul>
<li class="chapter" data-level="6.4.1" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#data-cleaning"><i class="fa fa-check"></i><b>6.4.1</b> Data cleaning</a></li>
<li class="chapter" data-level="6.4.2" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#study-area"><i class="fa fa-check"></i><b>6.4.2</b> Study area</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#point-pattern-analysis"><i class="fa fa-check"></i><b>6.5</b> Point pattern analysis</a><ul>
<li class="chapter" data-level="6.5.1" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#kernel-density-estimation"><i class="fa fa-check"></i><b>6.5.1</b> Kernel Density Estimation</a></li>
<li class="chapter" data-level="6.5.2" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#quadrat-analysis"><i class="fa fa-check"></i><b>6.5.2</b> Quadrat Analysis</a></li>
<li class="chapter" data-level="6.5.3" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#try-experimenting"><i class="fa fa-check"></i><b>6.5.3</b> Try experimenting…</a></li>
<li class="chapter" data-level="6.5.4" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#ripleys-k"><i class="fa fa-check"></i><b>6.5.4</b> Ripley’s K</a></li>
<li class="chapter" data-level="6.5.5" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#alternatives-to-ripleys-k"><i class="fa fa-check"></i><b>6.5.5</b> Alternatives to Ripley’s K</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#density-based-spatial-clustering-of-applications-with-noise-dbscan"><i class="fa fa-check"></i><b>6.6</b> Density-based spatial clustering of applications with noise: DBSCAN</a></li>
<li class="chapter" data-level="6.7" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#point-pattern-analysis-summary"><i class="fa fa-check"></i><b>6.7</b> Point pattern analysis summary</a></li>
<li class="chapter" data-level="6.8" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#analysing-spatial-autocorrelation-with-morans-i-lisa-and-friends"><i class="fa fa-check"></i><b>6.8</b> Analysing Spatial Autocorrelation with Moran’s I, LISA and friends</a><ul>
<li class="chapter" data-level="6.8.1" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#data-download-1"><i class="fa fa-check"></i><b>6.8.1</b> Data download</a></li>
<li class="chapter" data-level="6.8.2" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#data-cleaning-1"><i class="fa fa-check"></i><b>6.8.2</b> Data cleaning</a></li>
<li class="chapter" data-level="6.8.3" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#data-manipulation"><i class="fa fa-check"></i><b>6.8.3</b> Data manipulation</a></li>
<li class="chapter" data-level="6.8.4" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#spatial-autocorrelation"><i class="fa fa-check"></i><b>6.8.4</b> Spatial autocorrelation</a></li>
<li class="chapter" data-level="6.8.5" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#mapping-outputs"><i class="fa fa-check"></i><b>6.8.5</b> Mapping outputs</a></li>
<li class="chapter" data-level="6.8.6" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#other-variables"><i class="fa fa-check"></i><b>6.8.6</b> Other variables</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#extension-1"><i class="fa fa-check"></i><b>6.9</b> Extension</a></li>
<li class="chapter" data-level="6.10" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#arcmap-part-2"><i class="fa fa-check"></i><b>6.10</b> ArcMap part 2</a><ul>
<li class="chapter" data-level="6.10.1" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#getting-started-2"><i class="fa fa-check"></i><b>6.10.1</b> Getting started</a></li>
<li class="chapter" data-level="6.10.2" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#using-the-model-builder"><i class="fa fa-check"></i><b>6.10.2</b> Using the Model Builder</a></li>
<li class="chapter" data-level="6.10.3" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#extension-work"><i class="fa fa-check"></i><b>6.10.3</b> Extension work</a></li>
</ul></li>
<li class="chapter" data-level="6.11" data-path="analysing-spatial-patterns.html"><a href="analysing-spatial-patterns.html#feedback-5"><i class="fa fa-check"></i><b>6.11</b> Feedback</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="gwr-and-spatially-lagged-regression.html"><a href="gwr-and-spatially-lagged-regression.html"><i class="fa fa-check"></i><b>7</b> GWR and spatially lagged regression</a><ul>
<li class="chapter" data-level="7.1" data-path="gwr-and-spatially-lagged-regression.html"><a href="gwr-and-spatially-lagged-regression.html#recommended-listening-6"><i class="fa fa-check"></i><b>7.1</b> Recommended listening</a></li>
<li class="chapter" data-level="7.2" data-path="gwr-and-spatially-lagged-regression.html"><a href="gwr-and-spatially-lagged-regression.html#introduction-8"><i class="fa fa-check"></i><b>7.2</b> Introduction</a><ul>
<li class="chapter" data-level="7.2.1" data-path="gwr-and-spatially-lagged-regression.html"><a href="gwr-and-spatially-lagged-regression.html#setting-up-your-data-1"><i class="fa fa-check"></i><b>7.2.1</b> Setting up your Data</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="gwr-and-spatially-lagged-regression.html"><a href="gwr-and-spatially-lagged-regression.html#analysing-gcse-exam-performance---testing-a-research-hypothesis"><i class="fa fa-check"></i><b>7.3</b> Analysing GCSE exam performance - testing a research hypothesis</a><ul>
<li class="chapter" data-level="7.3.1" data-path="gwr-and-spatially-lagged-regression.html"><a href="gwr-and-spatially-lagged-regression.html#research-question-and-hypothesis"><i class="fa fa-check"></i><b>7.3.1</b> Research Question and Hypothesis</a></li>
<li class="chapter" data-level="7.3.2" data-path="gwr-and-spatially-lagged-regression.html"><a href="gwr-and-spatially-lagged-regression.html#regression-basics"><i class="fa fa-check"></i><b>7.3.2</b> Regression Basics</a></li>
<li class="chapter" data-level="7.3.3" data-path="gwr-and-spatially-lagged-regression.html"><a href="gwr-and-spatially-lagged-regression.html#running-a-regression-model-in-r"><i class="fa fa-check"></i><b>7.3.3</b> Running a Regression Model in R</a></li>
<li class="chapter" data-level="7.3.4" data-path="gwr-and-spatially-lagged-regression.html"><a href="gwr-and-spatially-lagged-regression.html#assumptions-underpinning-linear-regression"><i class="fa fa-check"></i><b>7.3.4</b> Assumptions Underpinning Linear Regression</a></li>
<li class="chapter" data-level="7.3.5" data-path="gwr-and-spatially-lagged-regression.html"><a href="gwr-and-spatially-lagged-regression.html#assumption-1---there-is-a-linear-relationship-between-the-dependent-and-independent-variables"><i class="fa fa-check"></i><b>7.3.5</b> Assumption 1 - There is a linear relationship between the dependent and Independent variables</a></li>
<li class="chapter" data-level="7.3.6" data-path="gwr-and-spatially-lagged-regression.html"><a href="gwr-and-spatially-lagged-regression.html#assumption-2---the-residuals-in-your-model-should-be-normally-distributed"><i class="fa fa-check"></i><b>7.3.6</b> Assumption 2 - The residuals in your model should be normally distributed</a></li>
<li class="chapter" data-level="7.3.7" data-path="gwr-and-spatially-lagged-regression.html"><a href="gwr-and-spatially-lagged-regression.html#assumption-3---no-multicolinearity-in-the-independent-variables"><i class="fa fa-check"></i><b>7.3.7</b> Assumption 3 - No Multicolinearity in the independent variables</a></li>
<li class="chapter" data-level="7.3.8" data-path="gwr-and-spatially-lagged-regression.html"><a href="gwr-and-spatially-lagged-regression.html#assumption-4---homoscedasticity"><i class="fa fa-check"></i><b>7.3.8</b> Assumption 4 - Homoscedasticity</a></li>
<li class="chapter" data-level="7.3.9" data-path="gwr-and-spatially-lagged-regression.html"><a href="gwr-and-spatially-lagged-regression.html#assumption-5---independence-of-errors"><i class="fa fa-check"></i><b>7.3.9</b> Assumption 5 - Independence of Errors</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="gwr-and-spatially-lagged-regression.html"><a href="gwr-and-spatially-lagged-regression.html#spatial-regression-models"><i class="fa fa-check"></i><b>7.4</b> Spatial Regression Models</a><ul>
<li class="chapter" data-level="7.4.1" data-path="gwr-and-spatially-lagged-regression.html"><a href="gwr-and-spatially-lagged-regression.html#dealing-with-spatially-autocorrelated-residuals---spatial-lag-and-spatial-error-models"><i class="fa fa-check"></i><b>7.4.1</b> Dealing with Spatially Autocorrelated Residuals - Spatial Lag and Spatial Error models</a></li>
<li class="chapter" data-level="7.4.2" data-path="gwr-and-spatially-lagged-regression.html"><a href="gwr-and-spatially-lagged-regression.html#section"><i class="fa fa-check"></i><b>7.4.2</b> </a></li>
<li class="chapter" data-level="7.4.3" data-path="gwr-and-spatially-lagged-regression.html"><a href="gwr-and-spatially-lagged-regression.html#extending-your-regression-model---dummy-variables"><i class="fa fa-check"></i><b>7.4.3</b> Extending your regression model - Dummy Variables</a></li>
<li class="chapter" data-level="7.4.4" data-path="gwr-and-spatially-lagged-regression.html"><a href="gwr-and-spatially-lagged-regression.html#task-investigating-further---adding-more-explanatory-variables-into-a-multiple-regression-model"><i class="fa fa-check"></i><b>7.4.4</b> TASK: Investigating Further - Adding More Explanatory Variables into a multiple regression model</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="gwr-and-spatially-lagged-regression.html"><a href="gwr-and-spatially-lagged-regression.html#task-3---spatial-non-stationarity-and-geographically-weighted-regression-models-gwr"><i class="fa fa-check"></i><b>7.5</b> Task 3 - Spatial Non-stationarity and Geographically Weighted Regression Models (GWR)</a></li>
<li class="chapter" data-level="7.6" data-path="gwr-and-spatially-lagged-regression.html"><a href="gwr-and-spatially-lagged-regression.html#arcgis-2"><i class="fa fa-check"></i><b>7.6</b> ArcGIS</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html"><i class="fa fa-check"></i><b>8</b> Advanced R, MAUP and more regression</a><ul>
<li class="chapter" data-level="8.1" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#learning-outcomes-6"><i class="fa fa-check"></i><b>8.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="8.2" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#recommended-listening-7"><i class="fa fa-check"></i><b>8.2</b> Recommended listening</a></li>
<li class="chapter" data-level="8.3" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#introduction-9"><i class="fa fa-check"></i><b>8.3</b> Introduction</a></li>
<li class="chapter" data-level="8.4" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#maup"><i class="fa fa-check"></i><b>8.4</b> MAUP</a><ul>
<li class="chapter" data-level="8.4.1" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#get-the-data"><i class="fa fa-check"></i><b>8.4.1</b> Get the data</a></li>
<li class="chapter" data-level="8.4.2" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#project-the-data"><i class="fa fa-check"></i><b>8.4.2</b> Project the data</a></li>
<li class="chapter" data-level="8.4.3" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#functions-1"><i class="fa fa-check"></i><b>8.4.3</b> Functions</a></li>
<li class="chapter" data-level="8.4.4" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#loops"><i class="fa fa-check"></i><b>8.4.4</b> Loops</a></li>
<li class="chapter" data-level="8.4.5" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#advanced-mapping-again"><i class="fa fa-check"></i><b>8.4.5</b> Advanced mapping (again)</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#regression-relationships"><i class="fa fa-check"></i><b>8.5</b> Regression relationships</a><ul>
<li class="chapter" data-level="8.5.1" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#preprocessing"><i class="fa fa-check"></i><b>8.5.1</b> Preprocessing</a></li>
<li class="chapter" data-level="8.5.2" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#scatter-plot"><i class="fa fa-check"></i><b>8.5.2</b> Scatter plot</a></li>
<li class="chapter" data-level="8.5.3" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#outliers"><i class="fa fa-check"></i><b>8.5.3</b> Outliers</a></li>
<li class="chapter" data-level="8.5.4" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#correlation"><i class="fa fa-check"></i><b>8.5.4</b> Correlation</a></li>
<li class="chapter" data-level="8.5.5" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#linear-model"><i class="fa fa-check"></i><b>8.5.5</b> Linear model</a></li>
<li class="chapter" data-level="8.5.6" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#linear-model-outputs"><i class="fa fa-check"></i><b>8.5.6</b> Linear model outputs</a></li>
<li class="chapter" data-level="8.5.7" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#validation"><i class="fa fa-check"></i><b>8.5.7</b> Validation</a></li>
<li class="chapter" data-level="8.5.8" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#cross-validation"><i class="fa fa-check"></i><b>8.5.8</b> Cross validation</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#advanced-regression"><i class="fa fa-check"></i><b>8.6</b> Advanced regression</a><ul>
<li class="chapter" data-level="8.6.1" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#more-data"><i class="fa fa-check"></i><b>8.6.1</b> More data</a></li>
<li class="chapter" data-level="8.6.2" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#multiple-linear-regression"><i class="fa fa-check"></i><b>8.6.2</b> Multiple linear regression</a></li>
<li class="chapter" data-level="8.6.3" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#ridge-regression"><i class="fa fa-check"></i><b>8.6.3</b> Ridge regression</a></li>
<li class="chapter" data-level="8.6.4" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#lasso"><i class="fa fa-check"></i><b>8.6.4</b> LASSO</a></li>
<li class="chapter" data-level="8.6.5" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#elastic-net-regression"><i class="fa fa-check"></i><b>8.6.5</b> Elastic net regression</a></li>
<li class="chapter" data-level="8.6.6" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#whats-the-best-here"><i class="fa fa-check"></i><b>8.6.6</b> What’s the best here</a></li>
<li class="chapter" data-level="8.6.7" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#what-should-i-use"><i class="fa fa-check"></i><b>8.6.7</b> What should i use</a></li>
<li class="chapter" data-level="8.6.8" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#so-how-do-i-predict"><i class="fa fa-check"></i><b>8.6.8</b> So how do i predict</a></li>
<li class="chapter" data-level="8.6.9" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#should-i-write-advanced-code"><i class="fa fa-check"></i><b>8.6.9</b> Should i write advanced code</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#more-resources"><i class="fa fa-check"></i><b>8.7</b> More resources</a></li>
<li class="chapter" data-level="8.8" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#extension-2"><i class="fa fa-check"></i><b>8.8</b> Extension</a></li>
<li class="chapter" data-level="8.9" data-path="advanced-r-maup-and-more-regression.html"><a href="advanced-r-maup-and-more-regression.html#acknowledgement"><i class="fa fa-check"></i><b>8.9</b> Acknowledgement</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="test.html"><a href="test.html"><i class="fa fa-check"></i><b>9</b> test</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">CASA0005 Geographic Information Systems and Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduction-to-r" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Introduction to R</h1>
<div id="learning-outcomes-1" class="section level2">
<h2><span class="header-section-number">2.1</span> Learning outcomes</h2>
<p>By the end of this practical you should be able to:</p>
<ol style="list-style-type: decimal">
<li>Execute basic processing in R</li>
<li>Examine, clean and manipulate comma seperate value (<code>.csv</code>) data</li>
<li>Examine, clean and manipulate and plot spatial (<code>.shp</code>) data</li>
<li>Produce interactive maps</li>
<li>Evaluate the benefits of different data manipulation and mapping techniques</li>
</ol>
</div>
<div id="recommended-listening-1" class="section level2">
<h2><span class="header-section-number">2.2</span> Recommended listening</h2>
<p>Some of these practicals are long, take regular breaks and have a listen to some of our fav tunes each week.</p>
<p><a href="https://www.youtube.com/watch?v=A48hOToMuRE">Andy</a></p>
<p><a href="https://open.spotify.com/album/0m9oaRdpRS9n0mq2bECgNQ?si=Dxu8_-kmSy6jq_oFN5gJ4A">Adam</a>. Recommended listening this week comes courtesy of “Pound for pound the best rock band on the planet at the minute. In my, not so humble opinion.” – Jake Burns, Stiff Little Fingers. Yes, it’s the Wildhearts and I can confirm that they are the greatest rock band on the planet! Wrap your ears around this:</p>
</div>
<div id="introduction-3" class="section level2">
<h2><span class="header-section-number">2.3</span> Introduction</h2>
<p>This practical is <strong>LONG</strong> but it will take you from not knowing much about R to making freaking cool interactive maps in one practical. As you can imagine, this will be a steep learning curve.</p>
<p>I will give you all the code you need, it’s your job to read through the text very carefully and try to understand what bits of code are doing as you go.</p>
<p>There will be bits of code you don’t fully understand. Don’t worry, the key is to revisit later and try to work out what is going on then. Learning R is a long and iterative process and this is just the start…</p>
<p>If you want to learn more about R and indeed download the latest version for your own use, then visit the <a href="http://www.r-project.org/">R project pages</a></p>
<p>The Wikipedia page for those who want to know a little of the history of R can be found <a href="http://en.wikipedia.org/wiki/R_(programming_language)">here</a></p>
<p>There is an almost endless supply of good R tutorials on the web. If you get stuck or want to learn even more R (and why would you not want to?!), I’d recommend trying some of the following R Tutorial websites:</p>
<ul>
<li><p><a href="http://www.statmethods.net/index.html" class="uri">http://www.statmethods.net/index.html</a></p></li>
<li><p><a href="http://www.r-tutor.com/" class="uri">http://www.r-tutor.com/</a></p></li>
<li><p><a href="http://www.cyclismo.org/tutorial/R/index.html" class="uri">http://www.cyclismo.org/tutorial/R/index.html</a></p></li>
<li><p><a href="http://www.cookbook-r.com/" class="uri">http://www.cookbook-r.com/</a></p></li>
</ul>
<p>If you want to really be up to date with the state of the art in R, then <a href="https://bookdown.org/">bookdown</a> is a fantastic resource. It features <strong>free</strong> books by some of the pre-eminent names in the R scene — I would urge you to go and take a look.</p>
<div id="online-forums-are-your-friend" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Online forums are your friend!!</h3>
<p>With almost every problem you encounter with R, someone else will have had the same problem before you and posted it on a forum –– someone will then post a solution below.</p>
<p>My usual route is to Google the problem and I’ll then be directed to a post, usually on Stack Overflow, Stack Exchange or Cross Validated. When doing so try to think about the minimal working (or not working) example (MWE), by this i mean remove anything very specific to your problem. I’ve rarely not found a solution to a problem this way.</p>
</div>
<div id="health-warning" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Health warning</h3>
<p>Beware of posting questions on these forums yourself – contributors to these forums (especially the R ones!), whilst almost always extremely knowledgeable about R, have a bit of a reputation for being insert familiar pejorative term for less-than-polite-human-being here! As you might expect, people who have enough time to become total experts in R, have little time to work on their social skills!! Fortunately though, some other poor chump has usually taken that hit for you and you can still find a useful answer to your problem.</p>
<p>If you are specifically more interested in the spatial side of R, then Alex Singleton and Chris Brunsdon at the Universities of Liverpool and Maynooth also have a number of very useful R Spatial Tutorials – <a href="http://rpubs.com/alexsingleton/" class="uri">http://rpubs.com/alexsingleton/</a> &amp; <a href="http://rpubs.com/chrisbrunsdon/" class="uri">http://rpubs.com/chrisbrunsdon/</a></p>
<p>Robin Lovelace in Leeds is also frequently at the bleeding edge of developments in R spatial stuff, so keep an eye on his <a href="http://robinlovelace.net/">website</a>. Robin has also made a book on GeoComputation in R, which you should definitely read! — <a href="https://geocompr.robinlovelace.net/" class="uri">https://geocompr.robinlovelace.net/</a></p>
<p>These websites are also very very good: <a href="https://pakillo.github.io/R-GIS-tutorial/" class="uri">https://pakillo.github.io/R-GIS-tutorial/</a> and <a href="http://www.maths.lancs.ac.uk/~rowlings/Teaching/UseR2012/cheatsheet.html" class="uri">http://www.maths.lancs.ac.uk/~rowlings/Teaching/UseR2012/cheatsheet.html</a></p>
</div>
<div id="r-and-rstudio" class="section level3">
<h3><span class="header-section-number">2.3.3</span> R and RStudio</h3>
<p>When you download and install R, you get the R Graphical User Interface (GUI) as standard (below). This is fine and some purists prefer using the clean, unfussy command-line original, but it has some limitations such as no graphical way to view data tables or keep track of what is in your working directory (there are a number of others too).</p>
<p><img src="prac2_images/R.png" width="500px" style="display: block; margin: auto;" /></p>
<p>Fortunately there are a number of software environments that have been developed for R to make it a little more user-friendly; the best of these by a long way is RStudio. RStudio can be downloaded for free from <a href="https://www.rstudio.com/" class="uri">https://www.rstudio.com/</a>. We covered the RStudio layout last week.</p>
</div>
<div id="getting-started-1" class="section level3">
<h3><span class="header-section-number">2.3.4</span> Getting started</h3>
<p>If you are some kind of masochist, you are welcome to use the bundled R GUI for all of your work. If pain is not your thing, then for this practical (and future practicals) I will assume that you are using RStudio.</p>
<ol style="list-style-type: decimal">
<li>From the start menu on your computer, find and run R Studio</li>
</ol>
<p>Once RStudio has opened, the first thing we will do is create a new project – projects enable you to organise your work effectively and store all of the files you create and work with for a particular task.</p>
<ol start="2" style="list-style-type: decimal">
<li><p>To create a new project (and this will vary a little depending on the version of RStudio you are using) select File &gt; New Project</p></li>
<li><p>Select Start a project in a brand new working directory and create a new project in a directory of a new ‘wk2’ directory on your N: drive:</p></li>
</ol>
<p><img src="prac2_images/r_newproject.png" width="500px" style="display: block; margin: auto;" /></p>
<p>My file directory (the second box here) will be different to yours as this is my teaching resources folder. Keep yours simple <code>N:/GIS/wk2</code>.</p>
<p>Setting up a project is extremely useful as it lets you easily access your data and files…for example….the flytipping <code>.csv</code> we used last week is stored at the file path</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">mycsv &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;C:/Teaching/CASA0005repo/Prac1_data/fly_tipping_borough_edit.csv&quot;</span>)  </a></code></pre></div>
<p>However as i’ve set my R project up in the CASA0005repo folder with different data folders for each week i can just use:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1">mycsv &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;Prac1_data/fly_tipping_borough_edit.csv&quot;</span>)  </a></code></pre></div>
<p>If i had the <code>.csv</code> file in the same folder as my project i could just use</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1">mycsv &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;fly_tipping_borough_edit.csv&quot;</span>)  </a></code></pre></div>
<p>You can run this in the Console area now or within a script which we will now go over…</p>
</div>
<div id="basics-1" class="section level3">
<h3><span class="header-section-number">2.3.5</span> Basics</h3>
<ol style="list-style-type: decimal">
<li>R has a very steep learning curve, but hopefully it won’t take long to get your head around the basics. For example, at its most simple R can be used as a calculator. In the console window (bottom left), just type the following and press enter:</li>
</ol>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="dv">1</span><span class="op">+</span><span class="dv">5</span></a></code></pre></div>
<pre><code>## [1] 6</code></pre>
<p>or</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="dv">4</span><span class="op">*</span><span class="dv">5</span><span class="op">^</span><span class="dv">2</span></a></code></pre></div>
<pre><code>## [1] 100</code></pre>
<p>As you can see R performs these calculations instantly and prints the results in the console. This is useful for quick calculations but less useful for writing scripts requiring multiple operations or saving these for future use.</p>
<ol start="2" style="list-style-type: decimal">
<li><p>To save your scripts, you should create a new R Script file. Do this now: Select File &gt; New File &gt; R Script.</p></li>
<li><p>The R Script should open up on the top-left of your GUI. <strong>From now on type everything in this R script file and save it</strong></p></li>
</ol>
</div>
<div id="scripts-and-some-basic-commands" class="section level3">
<h3><span class="header-section-number">2.3.6</span> Scripts and some basic commands</h3>
<ol start="4" style="list-style-type: decimal">
<li>Usually one of the first things to do when starting a new R Script is to check that you are in the correct working directory. This is important especially if you are working on multiple projects in different locations. To do this type the following into your new empty R Script:</li>
</ol>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="kw">getwd</span>()</a></code></pre></div>
<pre><code>## [1] &quot;C:/Users/ucfnmac/OneDrive - University College London/Teaching/CASA0005repo&quot;</code></pre>
<ol start="5" style="list-style-type: decimal">
<li><p>To run this line, hold Ctrl (Cmd on a Mac) and press the Return(↲) key (if you are in the standard R installation, you would run your script with Ctrl R). You should now see your current working directory appear in the console.</p></li>
<li><p>Because of the new project we have already set up, this working directory should be correct, but if for any reason we wanted to change the working directory, we would use the <code>setwd()</code> function. For example, we wanted to change our directory to the documents folder on the C drive, we could run (don’t do this now):</p></li>
</ol>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="kw">setwd</span>(<span class="st">&quot;C:/Documents&quot;</span>)</a></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li><p>When we are sure we are working in the correct working directory, we can save our script by clicking on the save icon on the script tab. Save your script as something like “wk2_part1” and you will see it appear in your files window on the right hand side. As you build up a document of R code, you should get into the habit of saving your script periodically in case of an unexpected software crash.</p></li>
<li><p>We can now begin to write a script without the need to run each line every time we press enter. In the script editor type:</p></li>
</ol>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1">A &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb46-2" title="2">B &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb46-3" title="3">C &lt;-<span class="st"> </span>A<span class="op">+</span>B</a>
<a class="sourceLine" id="cb46-4" title="4">C</a></code></pre></div>
<pre><code>## [1] 3</code></pre>
<ol start="9" style="list-style-type: decimal">
<li><p>Select (highlight) the three lines and run all three lines with Ctrl Return(↲). You will notice the lines appear in the console (the other window). If you type C and press enter in the console (C and then ctrl return in the script window) you should have the number 3 appear. From now on I recommend you type all the commands below in the script first and then run them. Copying and pasting from this document won’t necessarily work.</p></li>
<li><p>You will also notice that in RStudio, values A, B and C will appear in your workspace window (top right). These variables are stored in memory for future use. Try giving A and B different values and see what happens. What about if you use lower case letters?</p></li>
<li><p>You have just demonstrated one of the powerful aspects of R, which is that it is an <strong>object oriented</strong> programming language. A, B and C are all objects that have been assigned a value with the &lt;- symbol (you can also use the = sign, but it operates slightly differently to &lt;- in R, plus the arrow assignment has become standard over the years. Use <strong>alt -</strong> to type it automatically). This principle underlies the whole language and enables users to create ever more complex objects as they progress through their analysis. If you type:</p></li>
</ol>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="kw">ls</span>()</a></code></pre></div>
<pre><code>## [1] &quot;A&quot;     &quot;B&quot;     &quot;C&quot;     &quot;con&quot;   &quot;mycsv&quot; &quot;shape&quot;</code></pre>
<p>R will produce a list of objects that are currently active.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="kw">rm</span>(A)</a></code></pre></div>
<p>will remove the object A from the workspace (do <code>ls()</code> again to check this or look in your workspace window).</p>
</div>
<div id="functions" class="section level3">
<h3><span class="header-section-number">2.3.7</span> Functions</h3>
<ol start="12" style="list-style-type: decimal">
<li>Both <code>rm()</code> and <code>ls()</code> are known as functions. Functions are the other fundamental aspect to the R language. Functions can be thought of as single or multiple calculations that you apply to objects. They generally take the form of…(don’t run these)</li>
</ol>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1"><span class="cf">function</span>(object, argument1, argument2, argument3)</a></code></pre></div>
<p>Where the object is some form of data and the arguments parameterise what the function will do.</p>
<p>You could save the ouput to a new object using something like…</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">X&lt;-<span class="cf">function</span>(object, argument1, argument2, argument3)</a></code></pre></div>
<ol start="13" style="list-style-type: decimal">
<li>You can write your own functions to carry out tasks (and we’ll come onto that in subsequent practical sessions), but normally you will just used one of the virtually infinite number of functions that other people have already written for us.</li>
</ol>
</div>
<div id="basic-plotting" class="section level3">
<h3><span class="header-section-number">2.3.8</span> Basic plotting</h3>
<p>One common function is the <code>plot()</code> function for displaying data as a graphical output. Add these lines to your script and run them as before and you can see some <code>plot()</code> outputs:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="co">#create some datasets, first a vector of 1-100 and 101-200</span></a>
<a class="sourceLine" id="cb53-2" title="2">Data1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb53-3" title="3">Data2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">101</span><span class="op">:</span><span class="dv">200</span>)</a>
<a class="sourceLine" id="cb53-4" title="4"><span class="co">#Plot the data</span></a>
<a class="sourceLine" id="cb53-5" title="5"><span class="kw">plot</span>(Data1, Data2, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="co">#just for fun, create some more, this time some normally distributed</span></a>
<a class="sourceLine" id="cb54-2" title="2"><span class="co">#vectors of 100 numbers</span></a>
<a class="sourceLine" id="cb54-3" title="3">Data3 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dt">mean =</span> <span class="dv">53</span>, <span class="dt">sd=</span><span class="dv">34</span>)</a>
<a class="sourceLine" id="cb54-4" title="4">Data4 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dt">mean =</span> <span class="dv">64</span>, <span class="dt">sd=</span><span class="dv">14</span>)</a>
<a class="sourceLine" id="cb54-5" title="5"><span class="co">#plot</span></a>
<a class="sourceLine" id="cb54-6" title="6"><span class="kw">plot</span>(Data3, Data4, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-65-1.png" width="672" /></p>
<ol start="14" style="list-style-type: decimal">
<li>In the code above, you will have noticed the <code>#</code> symbol. This signifies that whatever comes after it on that line is a comment. Comments are ignored by the R console and they allow you to annotate your code so that you know what it is doing. It is good programming practice to comment your code extensively so that you can keep track of what your scripts are for.</li>
</ol>
<p><strong>Warning</strong> Heed our advice now and comment your code it will save you time in the future!</p>
</div>
<div id="help" class="section level3">
<h3><span class="header-section-number">2.3.9</span> Help</h3>
<ol start="15" style="list-style-type: decimal">
<li>The previous lines of code also demonstrated a number of functions: <code>c()</code> concatenates a string of numbers together into a vector. 1:100 means produce the integers between and including 1:100, the <code>plot()</code> function plots the two data objects and includes a parameter to change the colour of the points. To understand what a function does, you can consult the R Help system. Simply type a question mark and then the function name; for example:</li>
</ol>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1">?plot</a></code></pre></div>
<p><img src="prac2_images/rhelp.png" width="300px" style="display: block; margin: auto;" /></p>
<ol start="16" style="list-style-type: decimal">
<li>In RStudio you will see the help file appear in the Help window in the bottom right of the GUI. Here you can also search for the help files for other functions in the search bar.</li>
</ol>
</div>
<div id="data-types" class="section level3">
<h3><span class="header-section-number">2.3.10</span> Data types</h3>
<ol start="17" style="list-style-type: decimal">
<li>Objects in R can exist as a number of different data types. These include a <strong>matrix</strong>, a <strong>vector</strong>, a <strong>data frame</strong> and a <strong>list</strong>. For the purposes of this practical we will focus on data frames. These are the most flexible data format in R (although tibbles are now becoming popular as well). Data frames can be conceptualised in a similar way to a spreadsheet with data held in rows and columns. They are the most commonly used object type in R and the most straightforward to create from the two vector objects we just created.</li>
</ol>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Data1, Data2)</a>
<a class="sourceLine" id="cb56-2" title="2"><span class="kw">plot</span>(df, <span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</a></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
<ol start="18" style="list-style-type: decimal">
<li>If you have a very large data frame (thousands or millions of rows) it is useful to see only a selection of these. There are several ways of doing this:</li>
</ol>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="co">#show the first 10 and then last 10 rows of data in df...</span></a>
<a class="sourceLine" id="cb57-2" title="2"><span class="kw">head</span>(df)</a></code></pre></div>
<pre><code>##   Data1 Data2
## 1     1   101
## 2     2   102
## 3     3   103
## 4     4   104
## 5     5   105
## 6     6   106</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="kw">tail</span>(df)</a></code></pre></div>
<pre><code>##     Data1 Data2
## 95     95   195
## 96     96   196
## 97     97   197
## 98     98   198
## 99     99   199
## 100   100   200</code></pre>
<p>You can also view elements of your data frame in RStudio by simply clicking on it in the top-right Environment window:</p>
<p><img src="prac2_images/dataview.png" width="800px" style="display: block; margin: auto;" /></p>
</div>
<div id="elements-of-a-data-frame" class="section level3">
<h3><span class="header-section-number">2.3.11</span> Elements of a data frame</h3>
<ol start="19" style="list-style-type: decimal">
<li>When programming you will frequently want to refer to different elements in a data frame or a vector/list. To select elements of a data frame, or subset it, you can refer specifically to ranges or elements of rows and columns. These are accessed using the single square bracket operator <a href="gwr-and-spatially-lagged-regression.html#section"></a>, with the form:</li>
</ol>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1">data.frame[row,column]</a></code></pre></div>
<p>Rows are always referenced first, before the comma, columns second, after the comma.</p>
<ol start="20" style="list-style-type: decimal">
<li>Try the subsetting your df data frame with the following commands to see what is returned:</li>
</ol>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1">df[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">1</span>]</a></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1">df[<span class="dv">5</span><span class="op">:</span><span class="dv">15</span>,]</a></code></pre></div>
<pre><code>##    Data1 Data2
## 5      5   105
## 6      6   106
## 7      7   107
## 8      8   108
## 9      9   109
## 10    10   110
## 11    11   111
## 12    12   112
## 13    13   113
## 14    14   114
## 15    15   115</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1">df[<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">6</span>),<span class="dv">2</span>]</a></code></pre></div>
<pre><code>## [1] 102 103 106</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1">df[,<span class="dv">1</span>]</a></code></pre></div>
<pre><code>##   [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18
##  [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36
##  [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54
##  [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72
##  [73]  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90
##  [91]  91  92  93  94  95  96  97  98  99 100</code></pre>
<ol start="21" style="list-style-type: decimal">
<li>You will note that the column headings are the names of the original objects creating the data frame. We can change these using the <code>colnames()</code> function:</li>
</ol>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="kw">colnames</span>(df)&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;column1&quot;</span>, <span class="st">&quot;column2&quot;</span>)</a></code></pre></div>
<p>To select or refer to these columns directly by name, we can either use the <code>$</code> operator, which takes the form <code>data.frame$columnName</code>, e.g.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1">df<span class="op">$</span>column1</a></code></pre></div>
<pre><code>##   [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18
##  [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36
##  [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54
##  [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72
##  [73]  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90
##  [91]  91  92  93  94  95  96  97  98  99 100</code></pre>
<p>or we can use the double square bracket operator [<a href="gwr-and-spatially-lagged-regression.html#section"></a>], and refer to our column by name using quotes e.g.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1">df[[<span class="st">&quot;column1&quot;</span>]]</a></code></pre></div>
<pre><code>##   [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18
##  [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36
##  [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54
##  [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72
##  [73]  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90
##  [91]  91  92  93  94  95  96  97  98  99 100</code></pre>
<p>This again is useful if you have a lot of columns and you wish to efficiently extract one of them.</p>
</div>
</div>
<div id="reading-data-into-r" class="section level2">
<h2><span class="header-section-number">2.4</span> Reading data into R</h2>
<p>One of the most tedious things a spatial analyst / data scientist has to do is clean their data so it doesn’t cause problems for the software later. In the past, we would have needed to do this by hand — these days, we can use software to do much of this for us.</p>
<p>I will now give you two options to arrive at a nice cleaned dataset. If you have issues with software packages etc, you might still need to via the old skool route, however, the new skool route will be much more satisfying if it works!</p>
<p>For this example we are going to use the London Datastore Catalogue.</p>
<p>Go to: <a href="https://data.london.gov.uk/dataset/f33fb38c-cb37-48e3-8298-84c0d3cc5a6c" class="uri">https://data.london.gov.uk/dataset/f33fb38c-cb37-48e3-8298-84c0d3cc5a6c</a> and download the excel document for ward profiles.</p>
<div id="old-skool-cleaning" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Old skool cleaning</h3>
<ol start="22" style="list-style-type: decimal">
<li><p>Open the <code>ward-profiles-excel-version.xls</code> file in Excel, and save as <code>LondonData.csv</code> into your wk2/RProject folder.</p></li>
<li><p>Open your new <code>.csv</code> file in Excel. There might be some non-numeric values inside numeric columns which will cause problems in your analysis. These need to be removed before proceeding any further. To remove these, you can use the replace function in Excel. In the home tab under ‘Editing’ open up the find and replace dialogue box and enter the following into the find box:</p></li>
</ol>
<p><code>#VALUE!</code> <code>n/a</code></p>
<p>Leave the replace box empty each time and click Replace All to remove these from your file, before saving the file again.</p>
<ol start="24" style="list-style-type: decimal">
<li>Once you have cleaned out all of the trixy characters from the file, to read it into R, we will use the <code>read.csv()</code> function:</li>
</ol>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1">LondonDataOSK&lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;prac2_data/ward-profiles-excel-version.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>,  <span class="dt">encoding =</span> <span class="st">&quot;latin1&quot;</span>)</a></code></pre></div>
<blockquote>
<p><strong>Note</strong>, I’ve made an R project for all these practicals, which is why my file path starts with <code>prac2_data/</code>. If you save the <code>.csv</code> in the same folder as the <code>.Rproj</code> then you can just use:</p>
</blockquote>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1">LondonDataOSK&lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;ward-profiles-excel-version.csv&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;,&quot;</span>)</a></code></pre></div>
<p>If you look at the <code>read.csv()</code> help file - <code>?read.csv</code> - you will see that we can actually include many more parameters when reading in a .csv file. For example, we could read in the same file as follows:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="co"># by default in R, the file path should be defined with / but on a #windows file system it is defined with \. Using \\ instead allows R #to read the path correctly – alternatively, just use /</span></a>
<a class="sourceLine" id="cb77-2" title="2">LondonDataOSK&lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;prac2_data/ward-profiles-excel-version.csv&quot;</span>, </a>
<a class="sourceLine" id="cb77-3" title="3">                         <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="dt">encoding =</span> <span class="st">&quot;latin1&quot;</span>)</a></code></pre></div>
<p>This would specify that the first row of the file contains header information; and the values in the file are separated with commas (not ; or : as can be the case sometimes).</p>
</div>
<div id="new-skool-cleaning" class="section level3">
<h3><span class="header-section-number">2.4.2</span> New skool cleaning</h3>
<p>To clean our data as we read it in, we are going to use a package (more about packages later — for now, just think about it as a lovely gift from the R gods) called <code>readr</code> which comes bundled as part of the <code>tidyverse</code> package. If you want to find out more about the <code>tidyverse</code> (and you really should) then you should start <a href="https://www.tidyverse.org/">here</a> — the <code>tidyverse</code> package contains almost everything you need to become a kick-ass data scientist. ‘Tidy’ as a concept in data science is well worth reading about and you should start here with Hadley Wickham’s <a href="http://vita.had.co.nz/papers/tidy-data.pdf">paper</a></p>
<p>Anyway, first install the package:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</a></code></pre></div>
<p>Now we can use the <code>readr</code> package which comes bundled as part of the <code>tidyverse</code> to read in some data (directly from the web this time — <code>read.csv</code> can do this too) and clean text characters out from the numeric columns before they cause problems:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb79-2" title="2"><span class="co">#wang the data in straight from the web using read_csv, </span></a>
<a class="sourceLine" id="cb79-3" title="3"><span class="co">#skipping over the &#39;n/a&#39; entries as you go...</span></a>
<a class="sourceLine" id="cb79-4" title="4">LondonData &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://files.datapress.com/london/dataset/ward-profiles-and-atlas/2015-09-24T14:21:24/ward-profiles-excel-version.csv&quot;</span>,</a>
<a class="sourceLine" id="cb79-5" title="5">                       <span class="dt">locale =</span> <span class="kw">locale</span>(<span class="dt">encoding =</span> <span class="st">&quot;latin1&quot;</span>),</a>
<a class="sourceLine" id="cb79-6" title="6">                       <span class="dt">na =</span> <span class="st">&quot;n/a&quot;</span>)</a></code></pre></div>
<blockquote>
<p><strong>Note</strong> the use of read_csv here as opposed to read.csv. They are very similar, but read_csv is just a bit better. Read <a href="http://yetanothermathprogrammingconsultant.blogspot.com/2016/12/reading-csv-files-in-r-readcsv-vs.html">this</a> for more information. Also, for those python fans out there —IT’S NOT THE SAME FUNCTION AS READ_CSV IN PYTHON</p>
</blockquote>
<p>What is <code>locale = locale(encoding = "latin1")</code>…good question…it is basically the encoding of the data (how it is stored). There are a few different formats such as UTF-8 and latin1. In latin1 each character is 1 byte long, in UTF-8 a character can consist of more than 1 byte. To my knowledge the default in R is encoded as latin1, but <code>readr</code> (the package we are using to read in the <code>.csv</code> is UTF-8 so we have to specify it.</p>
</div>
<div id="examining-your-new-data" class="section level3">
<h3><span class="header-section-number">2.4.3</span> Examining your new data</h3>
<ol start="25" style="list-style-type: decimal">
<li>Your new data has been read in as a data frame / tibble (a tibble is just a data frame with a few extra bells and whistles). If you ever need to check what data type your new data set is, we can use the <code>class()</code> function:</li>
</ol>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="kw">class</span>(LondonData)</a></code></pre></div>
<pre><code>## [1] &quot;spec_tbl_df&quot; &quot;tbl_df&quot;      &quot;tbl&quot;         &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="co"># or, if you have your old skool data from step 24 above</span></a>
<a class="sourceLine" id="cb82-2" title="2"><span class="kw">class</span>(LondonDataOSK)</a></code></pre></div>
<p>We can also use the <code>class</code> function within another two functions <code>(cbind() and lapply())</code> to check that our data has been read in correctly and that, for example, numeric data haven’t been read in as text or other variables. Run the following line of code:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1">datatypelist &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">cbind</span>(<span class="kw">lapply</span>(LondonData,class)))</a></code></pre></div>
<p>You should see that all columns that should be numbers are read in as numeric. Try reading in LondonData again, but this time without excluding the ‘n/a’ values in the file, e.g.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1">LondonData &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://files.datapress.com/london/dataset/ward-profiles-and-atlas/2015-09-24T14:21:24/ward-profiles-excel-version.csv&quot;</span>, </a>
<a class="sourceLine" id="cb84-2" title="2">                       <span class="dt">locale =</span> <span class="kw">locale</span>(<span class="dt">encoding =</span> <span class="st">&quot;latin1&quot;</span>))</a></code></pre></div>
<p>Now run the datatypelist function again — you should see that some of the columns (those the n/a values in) have been read in as something other than numeric. This is why we need to exclude them. Isn’t <code>readr</code> great for helping us avoid reading in our numeric data as text!</p>
<p>To show this print the values in the column % children in reception year who are obese - 2011/12 to 2013/14 the column Mean Age - 2013</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="co"># col has n/a and is not numeric</span></a>
<a class="sourceLine" id="cb85-2" title="2">LondonData<span class="op">$</span><span class="st">`</span><span class="dt">% children in reception year who are obese - 2011/12 to 2013/14</span><span class="st">`</span></a></code></pre></div>
<pre><code>##   [1] &quot;11.1&quot; &quot;13.3&quot; &quot;10.0&quot; &quot;12.3&quot; &quot;12.8&quot; &quot;12.6&quot; &quot;11.5&quot; &quot;16.2&quot; &quot;16.2&quot; &quot;15.0&quot;
##  [11] &quot;11.4&quot; &quot;12.6&quot; &quot;14.8&quot; &quot;17.2&quot; &quot;15.6&quot; &quot;12.2&quot; &quot;12.9&quot; &quot;12.8&quot; &quot;10.8&quot; &quot;11.9&quot;
##  [21] &quot;12.2&quot; &quot;12.6&quot; &quot;10.0&quot; &quot;11.3&quot; &quot;7.9&quot;  &quot;10.9&quot; &quot;6.6&quot;  &quot;6.3&quot;  &quot;8.7&quot;  &quot;11.2&quot;
##  [31] &quot;7.4&quot;  &quot;4.5&quot;  &quot;11.3&quot; &quot;7.8&quot;  &quot;9.0&quot;  &quot;7.9&quot;  &quot;8.5&quot;  &quot;9.8&quot;  &quot;9.1&quot;  &quot;9.1&quot; 
##  [41] &quot;11.8&quot; &quot;8.5&quot;  &quot;9.7&quot;  &quot;6.1&quot;  &quot;11.8&quot; &quot;11.1&quot; &quot;10.1&quot; &quot;14.0&quot; &quot;11.5&quot; &quot;10.9&quot;
##  [51] &quot;13.4&quot; &quot;10.4&quot; &quot;13.3&quot; &quot;8.2&quot;  &quot;15.2&quot; &quot;11.0&quot; &quot;8.7&quot;  &quot;9.1&quot;  &quot;10.4&quot; &quot;17.1&quot;
##  [61] &quot;8.3&quot;  &quot;10.8&quot; &quot;8.3&quot;  &quot;13.2&quot; &quot;15.6&quot; &quot;10.5&quot; &quot;15.8&quot; &quot;11.6&quot; &quot;5.8&quot;  &quot;11.9&quot;
##  [71] &quot;13.7&quot; &quot;11.5&quot; &quot;13.0&quot; &quot;9.9&quot;  &quot;10.7&quot; &quot;17.0&quot; &quot;10.6&quot; &quot;13.1&quot; &quot;11.2&quot; &quot;9.2&quot; 
##  [81] &quot;15.0&quot; &quot;7.3&quot;  &quot;8.0&quot;  &quot;10.5&quot; &quot;5.8&quot;  &quot;4.2&quot;  &quot;6.0&quot;  &quot;7.1&quot;  &quot;7.8&quot;  &quot;9.1&quot; 
##  [91] &quot;8.4&quot;  &quot;9.6&quot;  &quot;11.4&quot; &quot;4.4&quot;  &quot;7.4&quot;  &quot;7.1&quot;  &quot;11.1&quot; &quot;9.2&quot;  &quot;10.4&quot; &quot;6.1&quot; 
## [101] &quot;9.2&quot;  &quot;3.9&quot;  &quot;6.8&quot;  &quot;10.9&quot; &quot;12.0&quot; &quot;11.6&quot; &quot;9.0&quot;  &quot;3.5&quot;  &quot;n/a&quot;  &quot;10.7&quot;
## [111] &quot;n/a&quot;  &quot;12.0&quot; &quot;5.3&quot;  &quot;9.0&quot;  &quot;6.5&quot;  &quot;13.4&quot; &quot;10.9&quot; &quot;12.6&quot; &quot;12.3&quot; &quot;13.8&quot;
## [121] &quot;6.1&quot;  &quot;10.3&quot; &quot;11.5&quot; &quot;13.2&quot; &quot;11.5&quot; &quot;9.4&quot;  &quot;9.6&quot;  &quot;8.9&quot;  &quot;10.2&quot; &quot;13.9&quot;
## [131] &quot;10.6&quot; &quot;4.5&quot;  &quot;11.3&quot; &quot;11.2&quot; &quot;8.1&quot;  &quot;7.7&quot;  &quot;14.6&quot; &quot;8.8&quot;  &quot;9.1&quot;  &quot;11.6&quot;
## [141] &quot;13.8&quot; &quot;10.5&quot; &quot;11.1&quot; &quot;12.6&quot; &quot;11.6&quot; &quot;11.1&quot; &quot;10.0&quot; &quot;14.0&quot; &quot;6.2&quot;  &quot;9.9&quot; 
## [151] &quot;11.1&quot; &quot;11.0&quot; &quot;13.7&quot; &quot;9.1&quot;  &quot;7.1&quot;  &quot;11.4&quot; &quot;12.9&quot; &quot;5.3&quot;  &quot;8.8&quot;  &quot;12.1&quot;
## [161] &quot;14.1&quot; &quot;12.3&quot; &quot;11.6&quot; &quot;11.6&quot; &quot;14.8&quot; &quot;14.3&quot; &quot;7.4&quot;  &quot;7.8&quot;  &quot;9.3&quot;  &quot;10.8&quot;
## [171] &quot;12.0&quot; &quot;9.0&quot;  &quot;17.6&quot; &quot;14.1&quot; &quot;16.3&quot; &quot;8.6&quot;  &quot;14.5&quot; &quot;8.9&quot;  &quot;12.8&quot; &quot;13.2&quot;
## [181] &quot;11.0&quot; &quot;16.7&quot; &quot;12.0&quot; &quot;9.5&quot;  &quot;9.7&quot;  &quot;10.8&quot; &quot;13.4&quot; &quot;14.7&quot; &quot;6.6&quot;  &quot;16.6&quot;
## [191] &quot;6.8&quot;  &quot;12.8&quot; &quot;10.5&quot; &quot;6.8&quot;  &quot;12.1&quot; &quot;13.8&quot; &quot;14.1&quot; &quot;11.1&quot; &quot;11.0&quot; &quot;11.5&quot;
## [201] &quot;7.0&quot;  &quot;14.1&quot; &quot;12.8&quot; &quot;16.9&quot; &quot;14.0&quot; &quot;15.4&quot; &quot;15.0&quot; &quot;12.1&quot; &quot;17.4&quot; &quot;8.9&quot; 
## [211] &quot;10.6&quot; &quot;13.7&quot; &quot;14.4&quot; &quot;10.7&quot; &quot;13.5&quot; &quot;14.8&quot; &quot;14.6&quot; &quot;10.7&quot; &quot;10.1&quot; &quot;18.2&quot;
## [221] &quot;12.9&quot; &quot;13.5&quot; &quot;10.7&quot; &quot;14.8&quot; &quot;15.8&quot; &quot;6.4&quot;  &quot;9.5&quot;  &quot;11.1&quot; &quot;12.8&quot; &quot;8.3&quot; 
## [231] &quot;12.1&quot; &quot;8.7&quot;  &quot;10.3&quot; &quot;8.0&quot;  &quot;9.1&quot;  &quot;9.1&quot;  &quot;7.7&quot;  &quot;14.5&quot; &quot;10.7&quot; &quot;12.5&quot;
## [241] &quot;10.5&quot; &quot;4.5&quot;  &quot;10.6&quot; &quot;14.8&quot; &quot;2.4&quot;  &quot;4.6&quot;  &quot;7.8&quot;  &quot;3.8&quot;  &quot;8.2&quot;  &quot;2.7&quot; 
## [251] &quot;14.2&quot; &quot;17.2&quot; &quot;11.1&quot; &quot;10.7&quot; &quot;5.8&quot;  &quot;13.9&quot; &quot;16.5&quot; &quot;13.8&quot; &quot;16.2&quot; &quot;12.0&quot;
## [261] &quot;7.1&quot;  &quot;13.1&quot; &quot;11.3&quot; &quot;10.9&quot; &quot;9.8&quot;  &quot;12.7&quot; &quot;6.8&quot;  &quot;4.8&quot;  &quot;8.1&quot;  &quot;11.6&quot;
## [271] &quot;10.4&quot; &quot;10.9&quot; &quot;10.4&quot; &quot;6.4&quot;  &quot;10.5&quot; &quot;6.0&quot;  &quot;9.5&quot;  &quot;9.7&quot;  &quot;9.3&quot;  &quot;11.8&quot;
## [281] &quot;7.3&quot;  &quot;8.0&quot;  &quot;9.0&quot;  &quot;11.0&quot; &quot;10.5&quot; &quot;14.3&quot; &quot;12.1&quot; &quot;7.7&quot;  &quot;9.7&quot;  &quot;12.8&quot;
## [291] &quot;3.9&quot;  &quot;10.6&quot; &quot;9.7&quot;  &quot;13.6&quot; &quot;10.2&quot; &quot;11.5&quot; &quot;11.3&quot; &quot;10.4&quot; &quot;6.8&quot;  &quot;11.5&quot;
## [301] &quot;9.8&quot;  &quot;10.3&quot; &quot;6.4&quot;  &quot;11.3&quot; &quot;5.9&quot;  &quot;10.0&quot; &quot;12.8&quot; &quot;9.0&quot;  &quot;7.0&quot;  &quot;9.3&quot; 
## [311] &quot;4.1&quot;  &quot;8.3&quot;  &quot;9.8&quot;  &quot;9.3&quot;  &quot;10.9&quot; &quot;7.4&quot;  &quot;12.3&quot; &quot;10.0&quot; &quot;5.9&quot;  &quot;10.4&quot;
## [321] &quot;11.0&quot; &quot;11.7&quot; &quot;12.6&quot; &quot;6.7&quot;  &quot;6.6&quot;  &quot;12.7&quot; &quot;12.7&quot; &quot;14.5&quot; &quot;13.1&quot; &quot;14.0&quot;
## [331] &quot;13.5&quot; &quot;10.5&quot; &quot;9.0&quot;  &quot;11.8&quot; &quot;10.8&quot; &quot;9.3&quot;  &quot;10.7&quot; &quot;10.7&quot; &quot;8.4&quot;  &quot;9.7&quot; 
## [341] &quot;7.3&quot;  &quot;9.9&quot;  &quot;12.4&quot; &quot;13.0&quot; &quot;9.1&quot;  &quot;12.9&quot; &quot;11.8&quot; &quot;6.3&quot;  &quot;11.4&quot; &quot;7.7&quot; 
## [351] &quot;13.7&quot; &quot;8.6&quot;  &quot;13.9&quot; &quot;8.7&quot;  &quot;11.4&quot; &quot;9.1&quot;  &quot;9.1&quot;  &quot;n/a&quot;  &quot;n/a&quot;  &quot;5.2&quot; 
## [361] &quot;14.0&quot; &quot;n/a&quot;  &quot;11.0&quot; &quot;6.4&quot;  &quot;13.3&quot; &quot;n/a&quot;  &quot;12.0&quot; &quot;n/a&quot;  &quot;n/a&quot;  &quot;n/a&quot; 
## [371] &quot;n/a&quot;  &quot;n/a&quot;  &quot;n/a&quot;  &quot;n/a&quot;  &quot;7.7&quot;  &quot;7.6&quot;  &quot;4.6&quot;  &quot;6.5&quot;  &quot;3.8&quot;  &quot;9.8&quot; 
## [381] &quot;8.1&quot;  &quot;4.9&quot;  &quot;5.2&quot;  &quot;6.0&quot;  &quot;11.3&quot; &quot;6.7&quot;  &quot;5.9&quot;  &quot;2.9&quot;  &quot;4.2&quot;  &quot;4.9&quot; 
## [391] &quot;3.3&quot;  &quot;15.6&quot; &quot;9.9&quot;  &quot;12.7&quot; &quot;12.0&quot; &quot;12.9&quot; &quot;15.2&quot; &quot;13.3&quot; &quot;9.9&quot;  &quot;9.1&quot; 
## [401] &quot;10.8&quot; &quot;9.9&quot;  &quot;10.0&quot; &quot;8.8&quot;  &quot;15.0&quot; &quot;13.2&quot; &quot;9.5&quot;  &quot;9.6&quot;  &quot;9.7&quot;  &quot;8.9&quot; 
## [411] &quot;13.6&quot; &quot;15.4&quot; &quot;11.9&quot; &quot;9.6&quot;  &quot;9.8&quot;  &quot;10.5&quot; &quot;6.8&quot;  &quot;12.2&quot; &quot;13.4&quot; &quot;9.0&quot; 
## [421] &quot;10.6&quot; &quot;7.3&quot;  &quot;8.6&quot;  &quot;12.0&quot; &quot;15.6&quot; &quot;9.7&quot;  &quot;13.7&quot; &quot;10.6&quot; &quot;11.3&quot; &quot;12.6&quot;
## [431] &quot;4.1&quot;  &quot;6.2&quot;  &quot;10.5&quot; &quot;11.9&quot; &quot;n/a&quot;  &quot;13.5&quot; &quot;12.4&quot; &quot;5.1&quot;  &quot;12.7&quot; &quot;14.6&quot;
## [441] &quot;9.3&quot;  &quot;4.7&quot;  &quot;10.9&quot; &quot;12.4&quot; &quot;2.0&quot;  &quot;11.9&quot; &quot;6.4&quot;  &quot;n/a&quot;  &quot;5.5&quot;  &quot;4.2&quot; 
## [451] &quot;13.0&quot; &quot;13.0&quot; &quot;15.0&quot; &quot;14.3&quot; &quot;12.2&quot; &quot;13.4&quot; &quot;10.7&quot; &quot;10.4&quot; &quot;16.2&quot; &quot;10.7&quot;
## [461] &quot;9.5&quot;  &quot;12.6&quot; &quot;12.8&quot; &quot;10.9&quot; &quot;13.0&quot; &quot;14.7&quot; &quot;12.4&quot; &quot;11.3&quot; &quot;10.2&quot; &quot;14.5&quot;
## [471] &quot;11.5&quot; &quot;7.6&quot;  &quot;9.6&quot;  &quot;13.6&quot; &quot;7.9&quot;  &quot;6.9&quot;  &quot;10.9&quot; &quot;12.2&quot; &quot;11.3&quot; &quot;9.8&quot; 
## [481] &quot;13.0&quot; &quot;9.7&quot;  &quot;11.8&quot; &quot;12.6&quot; &quot;7.5&quot;  &quot;14.9&quot; &quot;8.9&quot;  &quot;8.9&quot;  &quot;5.6&quot;  &quot;9.7&quot; 
## [491] &quot;9.5&quot;  &quot;4.8&quot;  &quot;5.0&quot;  &quot;5.6&quot;  &quot;5.0&quot;  &quot;5.3&quot;  &quot;7.8&quot;  &quot;6.4&quot;  &quot;9.6&quot;  &quot;3.5&quot; 
## [501] &quot;5.3&quot;  &quot;4.7&quot;  &quot;4.0&quot;  &quot;4.7&quot;  &quot;5.8&quot;  &quot;7.4&quot;  &quot;3.2&quot;  &quot;5.3&quot;  &quot;9.3&quot;  &quot;11.9&quot;
## [511] &quot;16.3&quot; &quot;11.4&quot; &quot;12.8&quot; &quot;14.1&quot; &quot;5.9&quot;  &quot;16.4&quot; &quot;19.0&quot; &quot;14.3&quot; &quot;15.0&quot; &quot;13.7&quot;
## [521] &quot;14.5&quot; &quot;15.9&quot; &quot;9.2&quot;  &quot;9.8&quot;  &quot;10.3&quot; &quot;11.2&quot; &quot;10.2&quot; &quot;8.5&quot;  &quot;13.2&quot; &quot;6.6&quot; 
## [531] &quot;6.3&quot;  &quot;8.6&quot;  &quot;7.9&quot;  &quot;6.4&quot;  &quot;5.9&quot;  &quot;7.1&quot;  &quot;4.6&quot;  &quot;11.5&quot; &quot;8.5&quot;  &quot;9.1&quot; 
## [541] &quot;9.5&quot;  &quot;8.2&quot;  &quot;8.3&quot;  &quot;8.0&quot;  &quot;7.2&quot;  &quot;8.3&quot;  &quot;10.0&quot; &quot;8.0&quot;  &quot;15.5&quot; &quot;14.5&quot;
## [551] &quot;10.8&quot; &quot;14.3&quot; &quot;10.6&quot; &quot;12.5&quot; &quot;12.8&quot; &quot;12.5&quot; &quot;13.4&quot; &quot;11.8&quot; &quot;9.0&quot;  &quot;12.4&quot;
## [561] &quot;10.7&quot; &quot;15.2&quot; &quot;14.2&quot; &quot;14.6&quot; &quot;13.4&quot; &quot;10.8&quot; &quot;11.9&quot; &quot;10.1&quot; &quot;8.4&quot;  &quot;8.9&quot; 
## [571] &quot;9.4&quot;  &quot;10.8&quot; &quot;6.9&quot;  &quot;8.1&quot;  &quot;10.0&quot; &quot;10.3&quot; &quot;10.7&quot; &quot;11.2&quot; &quot;11.4&quot; &quot;13.4&quot;
## [581] &quot;9.9&quot;  &quot;10.7&quot; &quot;11.5&quot; &quot;11.5&quot; &quot;12.0&quot; &quot;5.5&quot;  &quot;8.2&quot;  &quot;9.8&quot;  &quot;7.0&quot;  &quot;7.5&quot; 
## [591] &quot;10.1&quot; &quot;10.9&quot; &quot;13.7&quot; &quot;4.1&quot;  &quot;3.4&quot;  &quot;11.1&quot; &quot;11.8&quot; &quot;12.7&quot; &quot;7.8&quot;  &quot;6.6&quot; 
## [601] &quot;4.6&quot;  &quot;10.6&quot; &quot;8.6&quot;  &quot;9.6&quot;  &quot;12.4&quot; &quot;8.5&quot;  &quot;9.5&quot;  &quot;12.2&quot; &quot;14.6&quot; &quot;13.8&quot;
## [611] &quot;10.9&quot; &quot;11.6&quot; &quot;n/a&quot;  &quot;6.0&quot;  &quot;9.1&quot;  &quot;8.5&quot;  &quot;10.0&quot; &quot;11.0&quot; &quot;7.5&quot;  &quot;12.6&quot;
## [621] &quot;13.1&quot; &quot;10.0&quot; &quot;13.5&quot; &quot;11.7&quot; &quot;n/a&quot;  &quot;11.1&quot; &quot;13.6&quot; &quot;9.5&quot;  &quot;11.6&quot; &quot;12.2&quot;
## [631] &quot;7.8&quot;  &quot;9.8&quot;  &quot;11.1&quot; &quot;11.2&quot; &quot;12.7&quot; &quot;13.2&quot; &quot;13.3&quot; &quot;10.2&quot; &quot;11.1&quot; &quot;9.6&quot; 
## [641] &quot;10.3&quot; &quot;9.6&quot;  &quot;11.2&quot; &quot;10.6&quot; &quot;9.2&quot;  &quot;6.0&quot;  &quot;11.5&quot; &quot;11.0&quot; &quot;9.0&quot;  &quot;12.5&quot;
## [651] &quot;10.6&quot; &quot;5.7&quot;  &quot;12.8&quot; &quot;8.1&quot;  &quot;12.7&quot; &quot;10.6&quot; &quot;9.2&quot;  &quot;11.1&quot; &quot;10.8&quot; &quot;9.4&quot;</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="co"># no n/a values in this column</span></a>
<a class="sourceLine" id="cb87-2" title="2">LondonData<span class="op">$</span><span class="st">`</span><span class="dt">Mean Age - 2013</span><span class="st">`</span></a></code></pre></div>
<pre><code>##   [1] 41.3 29.5 33.8 33.0 36.2 37.7 33.4 29.0 34.1 34.4 35.2 33.9 34.3 33.4 28.7
##  [16] 34.8 34.5 35.3 38.9 33.7 36.1 32.1 36.3 38.3 37.2 37.1 39.1 39.1 33.0 37.1
##  [31] 34.9 40.7 37.1 39.8 39.6 39.2 37.5 35.2 37.9 40.8 36.1 40.5 40.5 43.2 40.6
##  [46] 37.3 37.7 39.4 40.2 40.5 34.9 39.6 38.8 42.2 33.6 39.2 42.4 38.2 41.8 32.0
##  [61] 35.3 35.8 37.0 34.8 34.7 36.0 33.0 35.4 40.2 34.6 35.0 37.3 35.9 35.6 36.2
##  [76] 32.2 35.1 34.9 35.8 35.6 33.7 41.8 40.9 39.6 37.5 41.6 42.6 37.2 40.6 38.2
##  [91] 37.3 34.6 43.2 43.8 41.4 40.9 37.0 41.9 35.8 42.8 38.8 42.5 42.3 37.1 34.1
## [106] 37.3 34.6 36.0 37.6 37.0 39.9 35.1 40.0 36.2 35.5 36.1 31.5 34.0 33.1 36.8
## [121] 35.4 35.5 38.0 34.8 32.0 42.3 39.8 37.1 35.2 32.0 40.1 39.0 35.4 37.0 39.0
## [136] 42.0 33.1 43.2 39.9 35.6 34.2 36.3 35.2 33.7 33.9 35.1 36.7 35.3 37.5 37.4
## [151] 33.5 35.5 34.3 36.0 37.4 36.0 36.3 36.5 36.3 35.0 33.7 35.7 36.2 35.1 34.2
## [166] 33.2 36.9 36.6 36.2 40.6 36.9 40.7 32.0 33.7 32.3 41.3 33.9 41.4 35.4 32.7
## [181] 37.5 32.4 33.9 37.8 38.9 38.9 34.6 32.8 39.3 33.8 39.3 35.2 40.3 41.2 37.9
## [196] 36.2 32.8 33.1 36.7 37.9 32.9 34.0 38.0 29.8 30.7 31.3 33.4 29.6 32.5 34.0
## [211] 33.4 33.6 34.0 33.6 32.7 32.5 33.1 33.1 31.3 30.3 34.2 29.6 34.6 33.4 32.8
## [226] 34.8 34.1 36.3 34.0 35.3 34.4 35.5 34.2 33.9 38.6 35.8 37.1 33.9 34.5 33.6
## [241] 33.5 36.7 34.9 33.5 37.0 36.6 34.2 37.7 35.4 38.4 33.7 32.1 33.8 31.4 35.5
## [256] 33.7 32.2 34.7 32.8 34.3 37.9 40.3 36.0 34.9 35.9 39.5 41.7 40.6 36.8 37.4
## [271] 38.9 35.1 42.1 40.3 36.0 38.0 34.3 35.7 42.4 34.5 37.4 36.5 44.1 41.4 43.6
## [286] 36.0 42.8 40.4 38.9 38.5 41.3 40.5 43.2 39.9 37.3 42.7 38.3 40.0 44.3 33.6
## [301] 32.8 33.6 39.4 35.7 42.4 39.8 34.5 35.4 42.4 39.2 42.7 40.3 32.7 36.4 33.5
## [316] 39.2 33.2 34.8 40.2 32.3 33.9 35.3 34.6 37.6 37.9 34.1 36.7 31.7 34.8 36.4
## [331] 35.2 35.2 34.4 34.0 32.6 37.7 35.1 35.2 36.7 35.1 38.3 34.9 32.5 34.0 35.5
## [346] 34.8 33.6 35.5 33.6 35.0 33.5 35.6 33.7 35.2 35.9 35.2 34.2 37.7 39.2 38.4
## [361] 38.3 35.6 40.4 36.8 36.5 40.5 37.8 39.7 37.0 37.8 36.3 37.5 43.8 37.1 39.6
## [376] 38.9 38.3 37.3 33.6 38.3 37.6 37.1 37.9 33.4 34.0 39.9 40.6 33.6 37.7 37.3
## [391] 38.5 34.9 33.6 33.4 33.8 32.4 33.4 33.9 34.3 34.2 32.9 34.3 35.5 34.1 33.8
## [406] 34.5 35.6 34.0 33.1 34.7 32.9 33.9 34.6 35.9 33.0 36.6 35.4 35.5 31.3 35.4
## [421] 36.8 34.8 36.4 33.6 31.8 35.5 34.0 36.2 33.4 34.7 34.8 40.1 34.6 34.7 35.7
## [436] 33.8 35.8 38.6 33.6 35.7 39.1 38.6 34.8 36.4 38.0 36.6 34.6 41.9 37.6 34.2
## [451] 30.5 31.9 32.6 31.6 31.7 32.0 32.2 31.2 32.7 31.7 30.9 31.9 30.3 31.4 32.0
## [466] 30.9 29.7 31.5 31.2 32.7 35.4 37.9 38.0 33.9 37.1 37.9 30.7 36.1 37.2 38.2
## [481] 32.7 36.7 30.2 34.6 43.0 33.3 35.3 32.9 40.3 32.6 39.5 39.0 38.2 38.1 40.4
## [496] 40.3 39.8 38.4 38.2 38.7 36.9 38.2 35.3 38.7 36.6 39.0 38.2 36.8 39.5 33.4
## [511] 33.5 33.5 31.6 36.7 35.6 33.3 32.8 32.7 33.3 34.1 34.8 32.2 34.5 34.3 33.2
## [526] 33.1 33.3 33.9 34.2 36.8 38.5 38.0 40.2 39.1 39.4 41.6 41.1 34.7 39.3 36.0
## [541] 39.5 40.3 38.5 37.8 37.8 40.2 33.8 37.4 32.2 30.2 30.8 32.7 32.9 29.3 30.3
## [556] 31.1 30.3 29.6 31.0 31.4 34.3 30.7 31.3 32.7 30.7 32.3 32.3 33.4 42.3 40.2
## [571] 34.2 32.9 36.5 38.9 33.3 32.7 33.4 38.5 32.6 32.1 34.5 32.7 37.2 33.4 34.0
## [586] 34.2 34.2 33.1 36.4 34.1 34.5 33.9 33.6 35.0 33.0 34.1 32.8 36.0 34.6 34.1
## [601] 35.8 33.3 34.6 34.5 36.7 38.1 37.1 36.6 36.6 35.7 34.7 35.6 37.2 35.2 36.5
## [616] 35.2 37.6 34.5 39.1 37.9 40.2 38.2 38.2 34.3 38.8 41.3 33.2 36.9 38.9 35.3
## [631] 39.8 35.8 36.6 35.6 36.1 34.7 32.6 34.9 34.4 37.7 40.3 36.2 35.3 34.4 38.3
## [646] 36.9 33.9 34.5 36.3 31.4 35.5 38.3 33.8 38.3 31.1 34.5 34.4 36.7 35.6 39.6</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1">LondonData &lt;-<span class="st"> </span><span class="kw">edit</span>(LondonData)</a></code></pre></div>
<ol start="27" style="list-style-type: decimal">
<li>It is also possible to quickly and easily summarise the data or look at the column headers using</li>
</ol>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="kw">summary</span>(df)</a></code></pre></div>
<pre><code>##     column1          column2     
##  Min.   :  1.00   Min.   :101.0  
##  1st Qu.: 25.75   1st Qu.:125.8  
##  Median : 50.50   Median :150.5  
##  Mean   : 50.50   Mean   :150.5  
##  3rd Qu.: 75.25   3rd Qu.:175.2  
##  Max.   :100.00   Max.   :200.0</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="kw">names</span>(LondonData)</a></code></pre></div>
<pre><code>##  [1] &quot;Ward name&quot;                                                                  
##  [2] &quot;Old code&quot;                                                                   
##  [3] &quot;New code&quot;                                                                   
##  [4] &quot;Population - 2015&quot;                                                          
##  [5] &quot;Children aged 0-15 - 2015&quot;                                                  
##  [6] &quot;Working-age (16-64) - 2015&quot;                                                 
##  [7] &quot;Older people aged 65+ - 2015&quot;                                               
##  [8] &quot;% All Children aged 0-15 - 2015&quot;                                            
##  [9] &quot;% All Working-age (16-64) - 2015&quot;                                           
## [10] &quot;% All Older people aged 65+ - 2015&quot;                                         
## [11] &quot;Mean Age - 2013&quot;                                                            
## [12] &quot;Median Age - 2013&quot;                                                          
## [13] &quot;Area - Square Kilometres&quot;                                                   
## [14] &quot;Population density (persons per sq km) - 2013&quot;                              
## [15] &quot;% BAME - 2011&quot;                                                              
## [16] &quot;% Not Born in UK - 2011&quot;                                                    
## [17] &quot;% English is First Language of no one in household - 2011&quot;                  
## [18] &quot;General Fertility Rate - 2013&quot;                                              
## [19] &quot;Male life expectancy -2009-13&quot;                                              
## [20] &quot;Female life expectancy -2009-13&quot;                                            
## [21] &quot;% children in reception year who are obese - 2011/12 to 2013/14&quot;            
## [22] &quot;% children in year 6 who are obese- 2011/12 to 2013/14&quot;                     
## [23] &quot;Rate of All Ambulance Incidents per 1,000 population - 2014&quot;                
## [24] &quot;Rates of ambulance call outs for alcohol related illness - 2014&quot;            
## [25] &quot;Number Killed or Seriously Injured on the roads - 2014&quot;                     
## [26] &quot;In employment (16-64) - 2011&quot;                                               
## [27] &quot;Employment rate (16-64) - 2011&quot;                                             
## [28] &quot;Number of jobs in area - 2013&quot;                                              
## [29] &quot;Employment per head of resident WA population - 2013&quot;                       
## [30] &quot;Rate of new registrations of migrant workers - 2011/12&quot;                     
## [31] &quot;Median House Price (£) - 2014&quot;                                              
## [32] &quot;Number of properties sold - 2014&quot;                                           
## [33] &quot;Median Household income estimate (2012/13)&quot;                                 
## [34] &quot;Number of Household spaces - 2011&quot;                                          
## [35] &quot;% detached houses - 2011&quot;                                                   
## [36] &quot;% semi-detached houses - 2011&quot;                                              
## [37] &quot;% terraced houses - 2011&quot;                                                   
## [38] &quot;% Flat, maisonette or apartment - 2011&quot;                                     
## [39] &quot;% Households Owned - 2011&quot;                                                  
## [40] &quot;% Households Social Rented - 2011&quot;                                          
## [41] &quot;% Households Private Rented - 2011&quot;                                         
## [42] &quot;% dwellings in council tax bands A or B - 2015&quot;                             
## [43] &quot;% dwellings in council tax bands C, D or E - 2015&quot;                          
## [44] &quot;% dwellings in council tax bands F, G or H - 2015&quot;                          
## [45] &quot;Claimant rate of key out-of-work benefits (working age client group) (2014)&quot;
## [46] &quot;Claimant Rate of Housing Benefit (2015)&quot;                                    
## [47] &quot;Claimant Rate of Employment Support Allowance - 2014&quot;                       
## [48] &quot;Rate of JobSeekers Allowance (JSA) Claimants - 2015&quot;                        
## [49] &quot;% dependent children (0-18) in out-of-work households - 2014&quot;               
## [50] &quot;% of households with no adults in employment with dependent children - 2011&quot;
## [51] &quot;% of lone parents not in employment - 2011&quot;                                 
## [52] &quot;(ID2010) - Rank of average score (within London) - 2010&quot;                    
## [53] &quot;(ID2010) % of LSOAs in worst 50% nationally - 2010&quot;                         
## [54] &quot;Average GCSE capped point scores - 2014&quot;                                    
## [55] &quot;Unauthorised Absence in All Schools (%) - 2013&quot;                             
## [56] &quot;% with no qualifications - 2011&quot;                                            
## [57] &quot;% with Level 4 qualifications and above - 2011&quot;                             
## [58] &quot;A-Level Average Point Score Per Student - 2013/14&quot;                          
## [59] &quot;A-Level Average Point Score Per Entry; 2013/14&quot;                             
## [60] &quot;Crime rate - 2014/15&quot;                                                       
## [61] &quot;Violence against the person rate - 2014/15&quot;                                 
## [62] &quot;Deliberate Fires per 1,000 population - 2014&quot;                               
## [63] &quot;% area that is open space - 2014&quot;                                           
## [64] &quot;Cars per household - 2011&quot;                                                  
## [65] &quot;Average Public Transport Accessibility score - 2014&quot;                        
## [66] &quot;% travel by bicycle to work - 2011&quot;                                         
## [67] &quot;Turnout at Mayoral election - 2012&quot;</code></pre>
</div>
<div id="data-manipulation-in-r" class="section level3">
<h3><span class="header-section-number">2.4.4</span> Data manipulation in R</h3>
<p>Now we have some data read into R, we need to select a small subset to work on. The first thing we will do is select just the London Boroughs to work with. If you recall, the Borough data is at the bottom of the file.</p>
<div id="selecting-rows" class="section level4">
<h4><span class="header-section-number">2.4.4.1</span> Selecting rows</h4>
<ol start="29" style="list-style-type: decimal">
<li>Your borough data will probably be found between rows 626 and 658. Therefore we will first create a subset by selecting these rows into a new data frame and then reducing that data frame to just four columns. There are a few ways of doing this:</li>
</ol>
<p>We could select just the rows we need by explicitly specifying the range of rows we need:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1">LondonBoroughs&lt;-LondonData[<span class="dv">626</span><span class="op">:</span><span class="dv">658</span>,]</a></code></pre></div>
<p>There is also a <code>subset()</code> function in R. You could look that up and see whether you could create a subset with that. Or, we could try a cool ‘data sciency’ way of pulling out the rows we want with the knowledge that the codes for London Boroughs start with E09 (the wards in the rest of the file start with E05).</p>
<p>Knowing this, we can use the <code>grep()</code> function which can use regular expressions to match patterns in text. Let’s try it!</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1">LondonData &lt;-<span class="st"> </span><span class="kw">data.frame</span>(LondonData)</a>
<a class="sourceLine" id="cb95-2" title="2">LondonBoroughs &lt;-<span class="st"> </span>LondonData[<span class="kw">grep</span>(<span class="st">&quot;^E09&quot;</span>,LondonData[,<span class="dv">3</span>]),]</a></code></pre></div>
<p>Check it worked:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1"><span class="kw">head</span>(LondonBoroughs)</a></code></pre></div>
<p><strong>AWWMAHGAWD!!!</strong> Pretty cool hey?</p>
<p>What that function is saying is <em>“grep (get) me all of the rows from the London Data data frame where the text in column 3 starts with (^) E09”</em></p>
<p>You will notice that you will have two rows at the top for the City of London. This is because it features twice in the data set. That’s fine, we can just drop this row from our dataset:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1">LondonBoroughs &lt;-<span class="st"> </span>LondonBoroughs[<span class="dv">2</span><span class="op">:</span><span class="dv">34</span>,]</a></code></pre></div>
</div>
<div id="selecting-columns" class="section level4">
<h4><span class="header-section-number">2.4.4.2</span> Selecting columns</h4>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1">LondonBoroughs&lt;-LondonBoroughs[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">21</span>)]</a></code></pre></div>
<ol start="30" style="list-style-type: decimal">
<li>You will have noticed the use of square brackets above –– these are very useful in R. Refer back to points 19-21 above if you can’t remember how they work. The <code>c()</code> function is also used here — this is the ‘combine’ function — another very useful function in R which allows arguments (in this case, column reference numbers) into a single value.</li>
</ol>
</div>
<div id="renaming-columns" class="section level4">
<h4><span class="header-section-number">2.4.4.3</span> Renaming columns</h4>
<ol start="31" style="list-style-type: decimal">
<li>You will notice that the column names are slightly misleading as we are now working with boroughs rather than wards. We can rename the columns to something more appropriate using the <code>names()</code> function (there are various other functions for renaming columns - for example <code>colnames()</code> if you want to rename multiple columns:</li>
</ol>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="co">#rename the column 1 in LondonBoroughs</span></a>
<a class="sourceLine" id="cb99-2" title="2"><span class="kw">names</span>(LondonBoroughs)[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Borough Name&quot;</span>)</a></code></pre></div>
</div>
</div>
<div id="plotting" class="section level3">
<h3><span class="header-section-number">2.4.5</span> Plotting</h3>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1"><span class="kw">plot</span>(LondonBoroughs<span class="op">$</span>Male.life.expectancy..<span class="fl">2009.13</span>,</a>
<a class="sourceLine" id="cb100-2" title="2">     LondonBoroughs<span class="op">$</span>X..children.in.reception.year.who.are.obese...<span class="dv">2011</span>.<span class="fl">12.</span>to.<span class="fl">2013.14</span>)</a></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-96-1.png" width="672" /></p>
</div>
<div id="pimp-my-graph" class="section level3">
<h3><span class="header-section-number">2.4.6</span> Pimp my graph!</h3>
<p>Now, of course, because this is R, we can pimp this graph using something a bit more fancy than the base graphics functions:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;plotly&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1"><span class="kw">library</span>(plotly)</a>
<a class="sourceLine" id="cb102-2" title="2"><span class="kw">plot_ly</span>(LondonBoroughs, </a>
<a class="sourceLine" id="cb102-3" title="3">        <span class="dt">x =</span> <span class="op">~</span>Male.life.expectancy..<span class="fl">2009.13</span>, </a>
<a class="sourceLine" id="cb102-4" title="4">        <span class="dt">y =</span> <span class="op">~</span>X..children.in.reception.year.who.are.obese...<span class="dv">2011</span>.<span class="fl">12.</span>to.<span class="fl">2013.14</span>, </a>
<a class="sourceLine" id="cb102-5" title="5">        <span class="dt">text =</span> <span class="op">~</span>LondonBoroughs<span class="op">$</span><span class="st">`</span><span class="dt">Borough Name</span><span class="st">`</span>, </a>
<a class="sourceLine" id="cb102-6" title="6">        <span class="dt">type =</span> <span class="st">&quot;scatter&quot;</span>, </a>
<a class="sourceLine" id="cb102-7" title="7">        <span class="dt">mode =</span> <span class="st">&quot;markers&quot;</span>)</a></code></pre></div>
<div id="htmlwidget-d75a05b64e76e0bcd4ed" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-d75a05b64e76e0bcd4ed">{"x":{"visdat":{"228c17977eba":["function () ","plotlyVisDat"]},"cur_data":"228c17977eba","attrs":{"228c17977eba":{"x":{},"y":{},"text":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Male.life.expectancy..2009.13"},"yaxis":{"domain":[0,1],"automargin":true,"title":"X..children.in.reception.year.who.are.obese...2011.12.to.2013.14","type":"category","categoryorder":"array","categoryarray":["10.2","10.3","10.6","11.0","11.1","11.2","11.5","11.6","12.2","12.5","12.7","12.8","13.2","13.3","13.6","5.7","6.0","7.8","8.1","9.0","9.2","9.5","9.6","9.8"]},"hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[84.3,77.7,81.9,80.3,80,81.3,81.1,80,79.9,80.6,78.7,78.2,79.1,80.1,82.4,79.8,80.4,79.7,78.2,82.6,81.3,78.4,78.7,80.3,78.5,80.7,81.9,78.6,80.8,77.5,79.7,79.2,81.7],"y":["11.1","13.6","9.5","11.6","12.2","7.8","9.8","11.1","11.2","12.7","13.2","13.3","10.2","11.1","9.6","10.3","9.6","11.2","10.6","9.2","6.0","11.5","11.0","9.0","12.5","10.6","5.7","12.8","8.1","12.7","10.6","9.2","11.1"],"text":["City of London","Barking and Dagenham","Barnet","Bexley","Brent","Bromley","Camden","Croydon","Ealing","Enfield","Greenwich","Hackney","Hammersmith and Fulham","Haringey","Harrow","Havering","Hillingdon","Hounslow","Islington","Kensington and Chelsea","Kingston upon Thames","Lambeth","Lewisham","Merton","Newham","Redbridge","Richmond upon Thames","Southwark","Sutton","Tower Hamlets","Waltham Forest","Wandsworth","Westminster"],"mode":"markers","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="spatial-data-in-r" class="section level3">
<h3><span class="header-section-number">2.4.7</span> Spatial Data in R</h3>
<p>This next part of the practical applies the same principles introduced above to the much more complex problem of handling spatial data within R. In this workshop we will produce a gallery of maps using many of the plotting tools available in R. The resulting maps will not be that meaningful — the focus here is on sound visualisation with R and not sound analysis (I know one is useless without the other!). Good quality spatial analysis will come in the rest of the module.</p>
<p>Whilst the instructions are step by step you are encouraged to start deviating from them (trying different colours for example) to get a better understanding of what we are doing.</p>
<div id="packages" class="section level4">
<h4><span class="header-section-number">2.4.7.1</span> Packages</h4>
<p>In this section we’ll require even more specialist packages, so I should probably spend some more time explaining what packages actually are! Packages are bits of code that extend R beyond the basic statistical functionality it was originally designed for. For spatial data, they enable R to process spatial data formats, carry out analysis tasks and create some of the maps that follow.</p>
<p>Bascially, without packages, R would be very limited. With packages, you can do virtually anything! One of the issues you will come across is that packages are being continually developed and updated and unless you keep your version of R updated and your packages updated, there may be some functions and options not available to you. This can be a problem, particularly with University installations which (at best) may only get updated once a year. Therefore, apologies in advance if things don’t work as intended!</p>
<ol style="list-style-type: decimal">
<li>In R Studio all packages can be installed and activated in the ‘Packages’ tab in the bottom-right hand window:</li>
</ol>
<p><img src="prac2_images/r_packages.png" width="500px" style="display: block; margin: auto;" /></p>
<ol start="2" style="list-style-type: decimal">
<li>As with everything else in R though, we can also run everything from the command line. The first package we need to install for this part of the practical is <code>maptools</code> –– either find and install it using the RStudio GUI or do the following:</li>
</ol>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;maptools&quot;</span>)</a></code></pre></div>
<p>There are a few other packages we’ll need to get to grips with. Some, like <code>ggplot2</code> (one of the most influential R packages ever) are part of the <code>tidyverse</code> package we came across earlier. Others we will need to install for the first time.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1"><span class="kw">install.packages</span>(<span class="kw">c</span>(<span class="st">&quot;classInt&quot;</span>, <span class="st">&quot;tmap&quot;</span>))</a>
<a class="sourceLine" id="cb104-2" title="2"></a>
<a class="sourceLine" id="cb104-3" title="3"><span class="co"># might also need these ones</span></a>
<a class="sourceLine" id="cb104-4" title="4"><span class="kw">install.packages</span>(<span class="kw">c</span>(<span class="st">&quot;RColorBrewer&quot;</span>, <span class="st">&quot;sp&quot;</span>, <span class="st">&quot;rgeos&quot;</span>, </a>
<a class="sourceLine" id="cb104-5" title="5">                   <span class="st">&quot;tmaptools&quot;</span>, <span class="st">&quot;sf&quot;</span>, <span class="st">&quot;downloader&quot;</span>, <span class="st">&quot;rgdal&quot;</span>, </a>
<a class="sourceLine" id="cb104-6" title="6">                   <span class="st">&quot;geojsonio&quot;</span>))</a></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li><p>Now that the packages have been installed you will not have to repeat the above steps again (when you use your account in these cluster rooms). Open a new script and save it to your working directory as <code>wk2_maps.r</code>. As before, type each of the lines of code into this window and then select and use the ctrl return keys to run them. Be sure to save your script often.</p></li>
<li><p>The first task is to load the packages we have just installed. Note, you might have some issues with the OpenStreetMap package if your installation of java on your computer doesn’t match your installation of R –– e.g. if you have installed the 64bit version of R, you also need the 64bit version of java (same with the 32bit versions) — you may also need to install the package Rcpp separately and try again.</p></li>
</ol>
<p>Install Java 64-bit from: <a href="https://java.com/en/download/manual.jsp" class="uri">https://java.com/en/download/manual.jsp</a></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1"><span class="co">#Load Packages (ignore any error messages about being built under a </span></a>
<a class="sourceLine" id="cb105-2" title="2"><span class="co">#different R version):</span></a>
<a class="sourceLine" id="cb105-3" title="3"><span class="kw">library</span>(maptools)</a>
<a class="sourceLine" id="cb105-4" title="4"><span class="kw">library</span>(RColorBrewer)</a>
<a class="sourceLine" id="cb105-5" title="5"><span class="kw">library</span>(classInt)</a>
<a class="sourceLine" id="cb105-6" title="6"><span class="kw">library</span>(sp)</a>
<a class="sourceLine" id="cb105-7" title="7"><span class="kw">library</span>(rgeos)</a>
<a class="sourceLine" id="cb105-8" title="8"><span class="kw">library</span>(tmap)</a>
<a class="sourceLine" id="cb105-9" title="9"><span class="kw">library</span>(tmaptools)</a>
<a class="sourceLine" id="cb105-10" title="10"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb105-11" title="11"><span class="kw">library</span>(rgdal)</a>
<a class="sourceLine" id="cb105-12" title="12"><span class="kw">library</span>(geojsonio)</a></code></pre></div>
</div>
<div id="background-to-spatial-data-in-r" class="section level4">
<h4><span class="header-section-number">2.4.7.2</span> Background to spatial data in R</h4>
<p>R has a very well developed ecosystem of packages for working with Spatial Data. Early pioneers like Roger Bivand and Edzer Pebesma along with various colleagues were instrumental in writing packages to interface with some powerful open source libraries for working with spatial data, such as GDAL and GEOS. These were accessed via the <code>rgdal</code> and <code>rgeos</code> packages. The <code>maptools</code> package by Roger Bivand, amongst other things, allowed Shapefiles to be read into R. The <code>sp</code> package (along with <code>spdep</code>) by Edzer Pebesma was very important for defining a series of classes and methods for spatial data natively in R which then allowed others to write software to work with these formats. Other packages like <code>raster</code> advanced the analysis of gridded spatial data, while packages like <code>classInt</code> and <code>RColorbrewer</code> facilitated the binning of data and colouring of choropleth maps.</p>
<p>Whilst these packages were extremely important for advancing spatial data analysis in R, they were not always the most straightforward to use — making a map in R could take quite a lot of effort and they were static and visually basic. However, more recently new packages have arrived to change this. Now <code>leaflet</code> enables R to interface with the leaflet javascript library for online, dynamic maps. <code>ggplot2</code> which was developed by Hadley Wickam and colleagues radically changed the way that people thought about and created graphical objects in R, including maps, and introduced a graphical style which has been the envy of other software to the extent that there are now libraries in Python which copy the <code>ggplot2</code> style!</p>
<p>Building on all of these, the new <code>tmap</code> (Thematic Map) package has changed the game completely and now enables us to read, write and manipulate spatial data and produce visually impressive and interactive maps, very easily. In parallel, the <code>sf</code> (Simple Features) package is helping us re-think the way that spatial data can be stored and manipulated. It’s exciting times for geographic information / spatial data science!</p>
</div>
<div id="making-some-choropleth-maps" class="section level4">
<h4><span class="header-section-number">2.4.7.3</span> Making some choropleth maps</h4>
<p>Choropleth maps are thematic maps which colour areas according to some phenomenon. In our case, we are going to fill some irregular polygons (the London Boroughs) with a colour that corresponds to a particular attribute.</p>
<p>As with all plots in R, there are multiple ways we can do this. The basic <code>plot()</code> function requires no data preparation but additional effort in colour selection/ adding the map key etc. <code>qplot()</code> and <code>ggplot()</code> (installed in the <code>ggplot2</code> package) require some additional steps to format the spatial data but select colours and add keys etc automatically. Here, we are going to make use of the new <code>tmap</code> package which makes making maps very easy indeed.</p>
<ol start="6" style="list-style-type: decimal">
<li>So one mega cool thing about R is you can read spatial data in straight from the internetz! Try this below for downloading a GeoJson file…it might take a few minutes…</li>
</ol>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1">EW &lt;-<span class="st"> </span>geojsonio<span class="op">::</span><span class="kw">geojson_read</span>(<span class="st">&quot;https://opendata.arcgis.com/datasets/8edafbe3276d4b56aec60991cbddda50_4.geojson&quot;</span>, <span class="dt">what =</span> <span class="st">&quot;sp&quot;</span>)</a></code></pre></div>
<p>Or you can do a manual download from <a href="http://geoportal.statistics.gov.uk/datasets/8edafbe3276d4b56aec60991cbddda50_2">here</a> — see point 7.</p>
<p>Pull out London using grep and the regex wildcard for ‘start of the string’ (^) to to look for the bit of the district code that relates to London (E09) from the ‘lad15cd’ column in the data slot of our spatial polygons dataframe</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1">LondonMap &lt;-<span class="st"> </span>EW[<span class="kw">grep</span>(<span class="st">&quot;^E09&quot;</span>,EW<span class="op">@</span>data<span class="op">$</span>lad15cd),]</a>
<a class="sourceLine" id="cb107-2" title="2"><span class="co">#plot it using the base plot function</span></a>
<a class="sourceLine" id="cb107-3" title="3"><span class="kw">qtm</span>(LondonMap)</a></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-104-1.png" width="672" /></p>
<ol start="7" style="list-style-type: decimal">
<li>Of course, we can also read in our data from a shapefile stored in a local directory:</li>
</ol>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1"><span class="co">#read the shapefile into a simple features object</span></a>
<a class="sourceLine" id="cb108-2" title="2">BoroughMapSF &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;prac1_data/statistical-gis-boundaries-london/ESRI/London_Borough_Excluding_MHW.shp&quot;</span>)</a></code></pre></div>
<pre><code>## Reading layer `London_Borough_Excluding_MHW&#39; from data source `C:\Users\ucfnmac\OneDrive - University College London\Teaching\CASA0005repo\prac1_data\statistical-gis-boundaries-london\ESRI\London_Borough_Excluding_MHW.shp&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 33 features and 7 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: 503568.2 ymin: 155850.8 xmax: 561957.5 ymax: 200933.9
## epsg (SRID):    NA
## proj4string:    +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.999601272 +x_0=400000 +y_0=-100000 +datum=OSGB36 +units=m +no_defs</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1">BoroughMapSP &lt;-<span class="st"> </span>LondonMap</a>
<a class="sourceLine" id="cb110-2" title="2"><span class="co">#plot it very quickly usking qtm (quick thematic map) to check</span></a>
<a class="sourceLine" id="cb110-3" title="3"><span class="co">#it has been read in correctly</span></a>
<a class="sourceLine" id="cb110-4" title="4"><span class="kw">qtm</span>(BoroughMapSF)</a></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-105-1.png" width="672" /></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1"><span class="kw">qtm</span>(BoroughMapSP)</a></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-106-1.png" width="672" /></p>
<ol start="8" style="list-style-type: decimal">
<li>And naturally we can convert between simple features objects and spatialPolygonsDataFrames very easily:</li>
</ol>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1"><span class="kw">library</span>(methods)</a>
<a class="sourceLine" id="cb112-2" title="2"><span class="co">#check the class of BoroughMapSF</span></a>
<a class="sourceLine" id="cb112-3" title="3"><span class="kw">class</span>(BoroughMapSF)</a></code></pre></div>
<pre><code>## [1] &quot;sf&quot;         &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1"><span class="co">#And check the class of BoroughMapSP</span></a>
<a class="sourceLine" id="cb114-2" title="2"><span class="kw">class</span>(BoroughMapSP)</a></code></pre></div>
<pre><code>## [1] &quot;SpatialPolygonsDataFrame&quot;
## attr(,&quot;package&quot;)
## [1] &quot;sp&quot;</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" title="1"><span class="co">#now convert the SP object into an SF object...</span></a>
<a class="sourceLine" id="cb116-2" title="2">newSF &lt;-<span class="st"> </span><span class="kw">st_as_sf</span>(BoroughMapSP)</a>
<a class="sourceLine" id="cb116-3" title="3"><span class="co">#and try the other way around SF to SP...</span></a>
<a class="sourceLine" id="cb116-4" title="4">newSP &lt;-<span class="st"> </span><span class="kw">as</span>(newSF, <span class="st">&quot;Spatial&quot;</span>)</a>
<a class="sourceLine" id="cb116-5" title="5"><span class="co">#simples!</span></a>
<a class="sourceLine" id="cb116-6" title="6">BoroughMapSP &lt;-<span class="st"> </span><span class="kw">as</span>(BoroughMapSF, <span class="st">&quot;Spatial&quot;</span>)</a></code></pre></div>
</div>
<div id="attribute-data" class="section level4">
<h4><span class="header-section-number">2.4.7.4</span> Attribute data</h4>
<p>OK, enough messing around, show us the maps!!</p>
<ol start="9" style="list-style-type: decimal">
<li>Hold your horses, before be can create a map, we need to join some attribute data to some boundaries. Doing this on a <code>SP</code> object can be a bit of a pain, but I’ll show you here:</li>
</ol>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1"><span class="co">#join the data to the @data slot in the SP data frame</span></a>
<a class="sourceLine" id="cb117-2" title="2">BoroughMapSP<span class="op">@</span>data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(BoroughMapSP<span class="op">@</span>data,LondonData[<span class="kw">match</span>(BoroughMapSP<span class="op">@</span>data[,<span class="st">&quot;GSS_CODE&quot;</span>],LondonData[,<span class="st">&quot;New.code&quot;</span>]),])</a>
<a class="sourceLine" id="cb117-3" title="3"><span class="co">#check it&#39;s joined.</span></a>
<a class="sourceLine" id="cb117-4" title="4"><span class="kw">head</span>(BoroughMapSP<span class="op">@</span>data)</a></code></pre></div>
<ol start="10" style="list-style-type: decimal">
<li>Joining data is a bit more intuitive with <code>merge()</code>:</li>
</ol>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1">BoroughDataMap&lt;-<span class="kw">merge</span>(BoroughMapSF, </a>
<a class="sourceLine" id="cb118-2" title="2">             LondonData, </a>
<a class="sourceLine" id="cb118-3" title="3">             <span class="dt">by.x=</span><span class="st">&quot;GSS_CODE&quot;</span>, </a>
<a class="sourceLine" id="cb118-4" title="4">             <span class="dt">by.y=</span><span class="st">&quot;New.code&quot;</span>,</a>
<a class="sourceLine" id="cb118-5" title="5">             <span class="dt">no.dups =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>An alternative to <code>merge()</code> would be to use a <code>left_join()</code> (like in SQL)</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1">BoroughDataMap2 &lt;-<span class="st"> </span>BoroughMapSF <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(LondonData, </a>
<a class="sourceLine" id="cb119-2" title="2">                                              <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;GSS_CODE&quot;</span> =<span class="st"> &quot;New.code&quot;</span>))</a></code></pre></div>
<p>However, you would need to remove the duplicate City of London row afterwards</p>
</div>
<div id="making-some-maps" class="section level4">
<h4><span class="header-section-number">2.4.7.5</span> Making some maps</h4>
<p>If you want to learn a bit more about the sorts of things you can do with tmap, then there are 2 vignettes that you can access <a href="https://cran.r-project.org/web/packages/tmap/">here</a> — I suggest you refer to these to see the various things you can do using tmap. Here’s a quick sample though:</p>
<ol start="11" style="list-style-type: decimal">
<li>We can create a choropleth map very quickly now using <code>qtm()</code></li>
</ol>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1"><span class="kw">library</span>(tmap)</a>
<a class="sourceLine" id="cb120-2" title="2"><span class="kw">library</span>(tmaptools)</a>
<a class="sourceLine" id="cb120-3" title="3"><span class="kw">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</a></code></pre></div>
<pre><code>## tmap mode set to plotting</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1"><span class="kw">qtm</span>(BoroughDataMap, </a>
<a class="sourceLine" id="cb122-2" title="2">    <span class="dt">fill =</span> <span class="st">&quot;Rate.of.JobSeekers.Allowance..JSA..Claimants...2015&quot;</span>)</a></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-114-1.png" width="672" /></p>
<p>You can also add a basemap and some other guff, if you wish…This part of the practical originally used the following code (do not run it):</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1"><span class="kw">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</a>
<a class="sourceLine" id="cb123-2" title="2"><span class="kw">st_transform</span>(BoroughDataMap, <span class="dv">4326</span>)</a>
<a class="sourceLine" id="cb123-3" title="3">london_osm &lt;-<span class="st"> </span>tmaptools<span class="op">::</span><span class="kw">read_osm</span>(BoroughDataMap, <span class="dt">type =</span> <span class="st">&quot;esri&quot;</span>, <span class="dt">zoom =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb123-4" title="4"><span class="kw">qtm</span>(BoroughDataMap) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb123-5" title="5"><span class="st">  </span><span class="kw">tm_shape</span>(BoroughDataMap) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb123-6" title="6"><span class="st">  </span><span class="kw">tm_polygons</span>(<span class="st">&quot;Rate.of.JobSeekers.Allowance..JSA..Claimants...2015&quot;</span>, </a>
<a class="sourceLine" id="cb123-7" title="7">        <span class="dt">style=</span><span class="st">&quot;jenks&quot;</span>,</a>
<a class="sourceLine" id="cb123-8" title="8">        <span class="dt">palette=</span><span class="st">&quot;YlOrBr&quot;</span>,</a>
<a class="sourceLine" id="cb123-9" title="9">        <span class="dt">midpoint=</span><span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb123-10" title="10">        <span class="dt">title=</span><span class="st">&quot;Rate per 1,000 people&quot;</span>,</a>
<a class="sourceLine" id="cb123-11" title="11">        <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb123-12" title="12"><span class="st">  </span><span class="kw">tm_compass</span>(<span class="dt">position =</span> <span class="kw">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>),<span class="dt">type =</span> <span class="st">&quot;arrow&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb123-13" title="13"><span class="st">  </span><span class="kw">tm_scale_bar</span>(<span class="dt">position =</span> <span class="kw">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb123-14" title="14"><span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">title =</span> <span class="st">&quot;Job seekers&#39; Allowance Claimants&quot;</span>, <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;bottom&quot;</span>))</a></code></pre></div>
<p>However, there seems to be an issue with <code>read_osm()</code> that means even the example data won’t work. I’ve logged the issue on GitHub and stackexchange and will most likely get some pretty direct comments. Have a look:</p>
<ul>
<li><a href="https://github.com/mtennekes/tmaptools/issues/17" class="uri">https://github.com/mtennekes/tmaptools/issues/17</a></li>
<li><a href="https://stackoverflow.com/questions/57408279/parameter-error-in-tmaptools-package-read-osm-when-using-example-data/57432541#57432541" class="uri">https://stackoverflow.com/questions/57408279/parameter-error-in-tmaptools-package-read-osm-when-using-example-data/57432541#57432541</a></li>
</ul>
<p>So in the mean time i’ve made a bit of a workaround that uses the packages <code>ggmap</code> and <code>ggplot</code>… You can find this later on in this practical when we cover <code>ggplot</code> and extra map features in (<a href="introduction-to-r.html#maps-with-extra-features">Maps with extra features</a>).</p>
<ol start="12" style="list-style-type: decimal">
<li>How about more than one map, perhaps using different data breaks…</li>
</ol>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" title="1"><span class="kw">tm_shape</span>(BoroughDataMap) <span class="op">+</span></a>
<a class="sourceLine" id="cb124-2" title="2"><span class="st">    </span><span class="kw">tm_polygons</span>(<span class="kw">c</span>(<span class="st">&quot;Average.Public.Transport.Accessibility.score...2014&quot;</span>, <span class="st">&quot;Violence.against.the.person.rate...2014.15&quot;</span>), </a>
<a class="sourceLine" id="cb124-3" title="3">        <span class="dt">style=</span><span class="kw">c</span>(<span class="st">&quot;jenks&quot;</span>, <span class="st">&quot;pretty&quot;</span>),</a>
<a class="sourceLine" id="cb124-4" title="4">        <span class="dt">palette=</span><span class="kw">list</span>(<span class="st">&quot;YlOrBr&quot;</span>, <span class="st">&quot;Purples&quot;</span>),</a>
<a class="sourceLine" id="cb124-5" title="5">        <span class="dt">auto.palette.mapping=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb124-6" title="6">        <span class="dt">title=</span><span class="kw">c</span>(<span class="st">&quot;Average Public Transport Accessibility&quot;</span>, <span class="st">&quot;Violence Against the Person Rate&quot;</span>))</a></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-116-1.png" width="672" /></p>
<p>You will notice that to choose the colour of the maps, I entered some codes. These are the names of colour ramps from the <code>RColourBrewer</code> package which comes bundled with <code>tmap</code>. <code>RColorBrewer</code> uses colour palettes available from the colorbrewer2 <a href="http://colorbrewer2.org/">website</a> which is in turn based on the <a href="http://www.personal.psu.edu/cab38/ColorBrewer/ColorBrewer_updates.html">work of Cynthia Brewer and colleagues at Penn State University</a>. Cynthia brewer has carried out large amount of academic research into determining the best colour palettes for GIS applications and so we will defer to her expertise here.</p>
<p>If you want to look at the range of colour palettes available, as we; as going to the ColorBrewer website, you can use the a little shiny app which comes bundled with <code>tmaptools</code></p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" title="1"><span class="co">#You might need to install the shinyjs package for this to work</span></a>
<a class="sourceLine" id="cb125-2" title="2"><span class="kw">install.packages</span>(<span class="st">&quot;shinyjs&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" title="1"><span class="kw">library</span>(shinyjs)</a>
<a class="sourceLine" id="cb126-2" title="2"><span class="co">#it&#39;s possible to explicitly tell R which </span></a>
<a class="sourceLine" id="cb126-3" title="3"><span class="co">#package to get the function from with the :: operator...</span></a>
<a class="sourceLine" id="cb126-4" title="4">tmaptools<span class="op">::</span><span class="kw">palette_explorer</span>()</a></code></pre></div>
<ol start="13" style="list-style-type: decimal">
<li><code>tmap</code> will even let you make a FRICKING INTERACTIVE MAP!!! Oh yes, we can do interactive maps…!</li>
</ol>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1"><span class="kw">tmap_mode</span>(<span class="st">&quot;view&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1">prac2truffle &lt;-<span class="st"> </span><span class="kw">tm_shape</span>(BoroughDataMap) <span class="op">+</span></a>
<a class="sourceLine" id="cb128-2" title="2"><span class="st">                </span><span class="kw">tm_polygons</span>(<span class="st">&quot;X..children.in.year.6.who.are.obese..2011.12.to.2013.14&quot;</span>,</a>
<a class="sourceLine" id="cb128-3" title="3">                <span class="dt">style=</span><span class="st">&quot;cont&quot;</span>,</a>
<a class="sourceLine" id="cb128-4" title="4">                <span class="dt">palette=</span><span class="st">&quot;PuRd&quot;</span>,</a>
<a class="sourceLine" id="cb128-5" title="5">                <span class="dt">midpoint=</span><span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb128-6" title="6">                <span class="dt">title=</span><span class="st">&quot;Truffle Shuffle Intensity&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb128-7" title="7"><span class="st">                </span><span class="kw">tmap_options</span>(<span class="dt">max.categories =</span> <span class="dv">5</span>)</a></code></pre></div>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1"><span class="co">####You can even save your map as an html file </span></a>
<a class="sourceLine" id="cb129-2" title="2"><span class="kw">tmap_save</span>(<span class="dt">filename =</span> <span class="st">&quot;truffle.html&quot;</span>)</a></code></pre></div>
</div>
<div id="have-a-play-around" class="section level4">
<h4><span class="header-section-number">2.4.7.6</span> Have a play around…</h4>
<p>There are loads of options for creating maps with <code>tmap</code> — read the vignettes that have been provided by the developers of the package and see if you can adapt the maps you have just made — or even make some alternative maps using built in data.</p>
<ul>
<li><a href="https://cran.r-project.org/web/packages/tmap/vignettes/tmap-nutshell.html" class="uri">https://cran.r-project.org/web/packages/tmap/vignettes/tmap-nutshell.html</a> * <a href="https://cran.r-project.org/web/packages/tmap/vignettes/tmap-modes.html" class="uri">https://cran.r-project.org/web/packages/tmap/vignettes/tmap-modes.html</a></li>
</ul>
<p>You should also read the reference manual on the <a href="https://cran.r-project.org/web/packages/tmap/">package homepage</a></p>
<p>In fact, since I wrote this the <code>tmap</code> package has developed quite a bit more — have a look at some of the cool examples <a href="https://github.com/mtennekes/tmap">here</a></p>
<p>Have a play and see what cool shiz you can create!</p>
<p>This is an example from the BubbleMap folder on the <code>tmap</code> GitHub. Don’t worry about what GitHub is we will cover that soon.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" title="1"><span class="co"># load spatial data included in the tmap package</span></a>
<a class="sourceLine" id="cb130-2" title="2"><span class="kw">data</span>(<span class="st">&quot;World&quot;</span>, <span class="st">&quot;metro&quot;</span>)</a>
<a class="sourceLine" id="cb130-3" title="3"></a>
<a class="sourceLine" id="cb130-4" title="4"><span class="co"># calculate annual growth rate</span></a>
<a class="sourceLine" id="cb130-5" title="5">metro<span class="op">$</span>growth &lt;-<span class="st"> </span>(metro<span class="op">$</span>pop2020 <span class="op">-</span><span class="st"> </span>metro<span class="op">$</span>pop2010) <span class="op">/</span><span class="st"> </span>(metro<span class="op">$</span>pop2010 <span class="op">*</span><span class="st"> </span><span class="dv">10</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb130-6" title="6"></a>
<a class="sourceLine" id="cb130-7" title="7"><span class="co"># plot</span></a>
<a class="sourceLine" id="cb130-8" title="8"><span class="kw">tm_shape</span>(World) <span class="op">+</span></a>
<a class="sourceLine" id="cb130-9" title="9"><span class="st">  </span><span class="kw">tm_polygons</span>(<span class="st">&quot;income_grp&quot;</span>, <span class="dt">palette =</span> <span class="st">&quot;-Blues&quot;</span>, </a>
<a class="sourceLine" id="cb130-10" title="10">    <span class="dt">title =</span> <span class="st">&quot;Income class&quot;</span>, <span class="dt">contrast =</span> <span class="fl">0.7</span>, <span class="dt">border.col =</span> <span class="st">&quot;gray30&quot;</span>, <span class="dt">id =</span> <span class="st">&quot;name&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb130-11" title="11"><span class="st">    </span><span class="kw">tm_text</span>(<span class="st">&quot;iso_a3&quot;</span>, <span class="dt">size =</span> <span class="st">&quot;AREA&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;gray30&quot;</span>, <span class="dt">root=</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb130-12" title="12"><span class="kw">tm_shape</span>(metro) <span class="op">+</span></a>
<a class="sourceLine" id="cb130-13" title="13"><span class="st">  </span><span class="kw">tm_bubbles</span>(<span class="st">&quot;pop2010&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;growth&quot;</span>, <span class="dt">border.col =</span> <span class="st">&quot;black&quot;</span>, </a>
<a class="sourceLine" id="cb130-14" title="14">    <span class="dt">border.alpha =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb130-15" title="15">    <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="ot">Inf</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="ot">Inf</span>) ,</a>
<a class="sourceLine" id="cb130-16" title="16">    <span class="dt">palette =</span> <span class="st">&quot;-RdYlGn&quot;</span>,</a>
<a class="sourceLine" id="cb130-17" title="17">    <span class="dt">title.size =</span> <span class="st">&quot;Metro population (2010)&quot;</span>, </a>
<a class="sourceLine" id="cb130-18" title="18">    <span class="dt">title.col =</span> <span class="st">&quot;Annual growth rate (%)&quot;</span>,</a>
<a class="sourceLine" id="cb130-19" title="19">    <span class="dt">id =</span> <span class="st">&quot;name&quot;</span>,</a>
<a class="sourceLine" id="cb130-20" title="20">    <span class="dt">popup.vars=</span><span class="kw">c</span>(<span class="st">&quot;pop2010&quot;</span>, <span class="st">&quot;pop2020&quot;</span>, <span class="st">&quot;growth&quot;</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb130-21" title="21"><span class="kw">tm_format</span>(<span class="st">&quot;World&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb130-22" title="22"><span class="kw">tm_style</span>(<span class="st">&quot;gray&quot;</span>)</a></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-122-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="making-maps-using-ggplot2" class="section level2">
<h2><span class="header-section-number">2.5</span> Making maps using ggplot2</h2>
<p>So as you have seen, it is possible to make very nice thematic maps with <code>tmap</code>. However, there are other options. The <code>ggplot2</code> package is a very powerful graphics package that allows us to a huge range of sophisticated plots, including maps.</p>
<p>The latest development version of <code>ggplot2</code> has support for simple features objects with the new <code>geom_sf</code> class (<a href="http://ggplot2.tidyverse.org/reference/ggsf.html" class="uri">http://ggplot2.tidyverse.org/reference/ggsf.html</a>), which, quite frankly, is bloody brilliant!</p>
<ol start="14" style="list-style-type: decimal">
<li><p>If you have not already done so, install and library the <code>ggplot2</code> and <code>rgeos</code> packages (they should be installed automatically as part of <code>tidyverse</code> and <code>tmap</code> packages, but occasionally they need to be installed separately).</p></li>
<li><p>Now there are two main ways in which you can construct a plot in <code>ggplot2</code>: <code>qplot()</code> and <code>ggplot()</code>. <code>qplot</code> is short for ‘Quick plot’ and can be good for producing quick charts and maps, but is perhaps less good for constructing complex layered plots. <code>ggplot()</code> is better for building up a plot layer by layer, e.g. <code>ggplot()+layer1+layer2</code>, and so this is what we will use here.</p></li>
<li><p>The important elements of any <code>ggplot</code> layer are the aesthetic mappings –– aes(x,y, …) –– which tell ggplot where to place the plot objects. We can imagine a map just like a graph with all features mapping to an x and y axis. All geometry ( <code>geom_</code>) types in ggplot feature some kind of aesthetic mapping and these can either be declared at the plot level, e.g. (don’t run this)</p></li>
</ol>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1"><span class="kw">ggplot</span>(data.frame, </a>
<a class="sourceLine" id="cb131-2" title="2">       <span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y))</a></code></pre></div>
<p>or, more flexibly at the level of the individual <code>geom_layer()</code>, e.g.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1"><span class="kw">geom_polygon</span>(<span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y), </a>
<a class="sourceLine" id="cb132-2" title="2">             data.frame)</a></code></pre></div>
<ol start="17" style="list-style-type: decimal">
<li>To begin our plot, we will start with the map layer –– we will generate this using the <code>geom_sf()</code> function in <code>ggplot2</code>:</li>
</ol>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb133-2" title="2"><span class="kw">ggplot</span>()<span class="op">+</span><span class="kw">geom_sf</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">geometry=</span>geometry),</a>
<a class="sourceLine" id="cb133-3" title="3">                 <span class="dt">data =</span> BoroughDataMap)<span class="op">+</span></a>
<a class="sourceLine" id="cb133-4" title="4"><span class="st">  </span><span class="kw">theme_minimal</span>()</a></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-126-1.png" width="672" /></p>
<ol start="18" style="list-style-type: decimal">
<li>To colour your map, then just pass the name of the variable you want to map to the fill parameter in the aesthetics:</li>
</ol>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" title="1"><span class="kw">ggplot</span>()<span class="op">+</span><span class="kw">geom_sf</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">geometry=</span>geometry, </a>
<a class="sourceLine" id="cb134-2" title="2">                               <span class="dt">fill=</span>Median.Household.income.estimate..<span class="dv">2012</span>.<span class="fl">13.</span>),</a>
<a class="sourceLine" id="cb134-3" title="3">                 <span class="dt">data =</span> BoroughDataMap)<span class="op">+</span></a>
<a class="sourceLine" id="cb134-4" title="4"><span class="st">  </span><span class="kw">theme_minimal</span>()</a></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-127-1.png" width="672" /></p>
<ol start="19" style="list-style-type: decimal">
<li>As you can see, this map looks OK, but there are a few issues with things like the colour ramp and a lack of appropriate labels. We can correct this by adding a few more layers. Firstly we can change the palette:</li>
</ol>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1">palette1&lt;-<span class="kw">scale_fill_continuous</span>(<span class="dt">low=</span><span class="st">&quot;white&quot;</span>, </a>
<a class="sourceLine" id="cb135-2" title="2">                                <span class="dt">high=</span><span class="st">&quot;orange&quot;</span>, </a>
<a class="sourceLine" id="cb135-3" title="3">                                <span class="st">&quot;Value (£)&quot;</span>)</a></code></pre></div>
<ol start="20" style="list-style-type: decimal">
<li>And some appropriate labels:</li>
</ol>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" title="1">labels&lt;-<span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Median household income estimate 2012 to 2013&quot;</span>,</a>
<a class="sourceLine" id="cb136-2" title="2">             <span class="dt">x=</span><span class="st">&quot;Longitude&quot;</span>, </a>
<a class="sourceLine" id="cb136-3" title="3">             <span class="dt">y=</span><span class="st">&quot;Latitude&quot;</span>)</a></code></pre></div>
<ol start="21" style="list-style-type: decimal">
<li>Before plotting the all of them together:</li>
</ol>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1"><span class="kw">ggplot</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb137-2" title="2"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">geometry=</span>geometry,</a>
<a class="sourceLine" id="cb137-3" title="3">                        <span class="dt">fill =</span> Median.Household.income.estimate..<span class="dv">2012</span>.<span class="fl">13.</span>)</a>
<a class="sourceLine" id="cb137-4" title="4">          ,<span class="dt">data =</span> BoroughDataMap)<span class="op">+</span></a>
<a class="sourceLine" id="cb137-5" title="5"><span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb137-6" title="6"><span class="st">  </span>palette1<span class="op">+</span></a>
<a class="sourceLine" id="cb137-7" title="7"><span class="st">  </span>labels</a></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-130-1.png" width="672" /></p>
<p>Check out <a href="https://www.r-spatial.org/r/2018/10/25/ggplot2-sf.html">this</a> resource for more options in <code>ggplot</code></p>
<div id="changing-projections" class="section level3">
<h3><span class="header-section-number">2.5.1</span> Changing projections</h3>
<p>Now until now, we’ve not really considered how our maps have been printed to the screen. The coordinates stored in the <code>geometry</code> column of your <code>sf</code> object contain the information to enable points, lines or polygons to be drawn on the screen. The first <code>ggplot</code> map above could fool you into thinking the coordinate system we are using is latitude and longitude, but actually, the map coordinates are stored in British National Grid.</p>
<p>How can we tell?</p>
<p>You can check that the coordinate reference systems of <code>sf</code> or <code>sp</code> objects using the print function:</p>
<pre><code>## class       : SpatialPolygonsDataFrame 
## features    : 33 
## extent      : 503568.2, 561957.5, 155850.8, 200933.9  (xmin, xmax, ymin, ymax)
## crs         : +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.999601272 +x_0=400000 +y_0=-100000 +datum=OSGB36 +units=m +no_defs +ellps=airy +towgs84=446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894 
## variables   : 74
## names       :                 NAME,  GSS_CODE,  HECTARES, NONLD_AREA, ONS_INNER, SUB_2009, SUB_2006,            Ward.name, Old.code,  New.code, Population...2015, Children.aged.0.15...2015, Working.age..16.64....2015, Older.people.aged.65....2015, X..All.Children.aged.0.15...2015, ... 
## min values  : Barking and Dagenham, E09000001,   314.942,          0,         F,       NA,       NA, Barking and Dagenham,     00AA, E09000001,              8100,                       650,                       6250,                         1250,                                8, ... 
## max values  :          Westminster, E09000033, 15013.487,    370.619,         T,       NA,       NA,          Westminster,     00BK, E09000033,            393200,                     82900,                     257850,                        56550,                             26.1, ...</code></pre>
<pre><code>## Simple feature collection with 33 features and 7 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: 503568.2 ymin: 155850.8 xmax: 561957.5 ymax: 200933.9
## epsg (SRID):    NA
## proj4string:    +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.999601272 +x_0=400000 +y_0=-100000 +datum=OSGB36 +units=m +no_defs
## First 10 features:
##                    NAME  GSS_CODE  HECTARES NONLD_AREA ONS_INNER SUB_2009
## 1  Kingston upon Thames E09000021  3726.117      0.000         F     &lt;NA&gt;
## 2               Croydon E09000008  8649.441      0.000         F     &lt;NA&gt;
## 3               Bromley E09000006 15013.487      0.000         F     &lt;NA&gt;
## 4              Hounslow E09000018  5658.541     60.755         F     &lt;NA&gt;
## 5                Ealing E09000009  5554.428      0.000         F     &lt;NA&gt;
## 6              Havering E09000016 11445.735    210.763         F     &lt;NA&gt;
## 7            Hillingdon E09000017 11570.063      0.000         F     &lt;NA&gt;
## 8                Harrow E09000015  5046.330      0.000         F     &lt;NA&gt;
## 9                 Brent E09000005  4323.270      0.000         F     &lt;NA&gt;
## 10               Barnet E09000003  8674.837      0.000         F     &lt;NA&gt;
##    SUB_2006                       geometry
## 1      &lt;NA&gt; MULTIPOLYGON (((516401.6 16...
## 2      &lt;NA&gt; MULTIPOLYGON (((535009.2 15...
## 3      &lt;NA&gt; MULTIPOLYGON (((540373.6 15...
## 4      &lt;NA&gt; MULTIPOLYGON (((521975.8 17...
## 5      &lt;NA&gt; MULTIPOLYGON (((510253.5 18...
## 6      &lt;NA&gt; MULTIPOLYGON (((549893.9 18...
## 7      &lt;NA&gt; MULTIPOLYGON (((510599.8 19...
## 8      &lt;NA&gt; MULTIPOLYGON (((510599.8 19...
## 9      &lt;NA&gt; MULTIPOLYGON (((525201 1825...
## 10     &lt;NA&gt; MULTIPOLYGON (((524579.9 19...</code></pre>
<div id="proj4" class="section level4">
<h4><span class="header-section-number">2.5.1.1</span> Proj4</h4>
<p>If you’re a spatial geek and you’re used to looking at London, then a quick glance at the values of the extent / bounding box (bbox) will tell you that you are working in British National Grid as the x and y values are in 6 Figures, with x values around 52000 to 55000 and y values around 15000 to 20000. The other way of telling is by looking at the coordinate reference system (CRS) value — in the files above it’s defined by the bit that says:</p>
<p><code>+proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy</code></p>
<p>“Well that’s clear as mud!” I hear you cry! Yes, not obvious is it! This is called a proj-string or proj4-string and its the proj4-string for British National Grid. You can learn what each of the bits of this mean <a href="https://proj4.org/usage/quickstart.html">here</a></p>
<p>The proj4-string basically tells the computer where on the earth to locate the coordinates that make up the geometries in your file and what distortions to apply (i.e. if to flatten it out completely etc.)</p>
<ol start="24" style="list-style-type: decimal">
<li>Sometimes you can download data from the web and it doesn’t have a CRS . If any boundary data you download does not have a coordinate reference system attached to it (NA is displayed in the coord. ref section), this is not a huge problem — it can be added afterwards by adding the proj4string to the file.</li>
</ol>
<p>To find the proj4-strings for a whole range of different geographic projections, use the search facility at <a href="http://spatialreference.org/" class="uri">http://spatialreference.org/</a> or <a href="http://epsg.io/" class="uri">http://epsg.io/</a>.</p>
</div>
<div id="epsg" class="section level4">
<h4><span class="header-section-number">2.5.1.2</span> EPSG</h4>
<p>Now, if you can store a whole proj4-string in your mind, you must be some kind of savant (why are you doing this course? you could make your fortune as a card-counting poker player or something!). The rest of us need something a little bit more easy to remember and for coordinate reference systems, the saviour is the European Petroleum Survey Group (EPSG) — (naturally!). Now managed and maintained by the <a href="http://www.epsg.org/">International Association of Oil and Gas producers</a> — EPSG codes are short numbers represent all coordinate reference systems in the world and link directly to proj4 strings.</p>
<p>The EPSG code for British National Grid is 27700 — <a href="http://epsg.io/27700" class="uri">http://epsg.io/27700</a>. The EPSG code for the WGS84 World Geodetic System (usually the default CRS for most spatial data) is 4326 — <a href="http://epsg.io/4326" class="uri">http://epsg.io/4326</a></p>
<ol start="26" style="list-style-type: decimal">
<li>If your boundary data doesn’t have a spatial reference system, you can read it in you can read it in and set the projection either with the full proj4 string, or, more easily, with the EPSG code:</li>
</ol>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" title="1"><span class="co"># read borough map in and explicitly set projection to British National Grid </span></a>
<a class="sourceLine" id="cb140-2" title="2"><span class="co"># using the EPSG string code 27700</span></a>
<a class="sourceLine" id="cb140-3" title="3">BoroughMapSF &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;prac1_data/statistical-gis-boundaries-london/ESRI/London_Borough_Excluding_MHW.shp&quot;</span>) </a></code></pre></div>
<pre><code>## Reading layer `London_Borough_Excluding_MHW&#39; from data source `C:\Users\ucfnmac\OneDrive - University College London\Teaching\CASA0005repo\prac1_data\statistical-gis-boundaries-london\ESRI\London_Borough_Excluding_MHW.shp&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 33 features and 7 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: 503568.2 ymin: 155850.8 xmax: 561957.5 ymax: 200933.9
## epsg (SRID):    NA
## proj4string:    +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.999601272 +x_0=400000 +y_0=-100000 +datum=OSGB36 +units=m +no_defs</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" title="1">BoroughMapSF &lt;-<span class="st"> </span><span class="kw">st_set_crs</span>(BoroughMapSF, <span class="dv">27700</span>)</a></code></pre></div>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" title="1"><span class="co">#or more concisely</span></a>
<a class="sourceLine" id="cb143-2" title="2">BoroughMapSF &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;prac1_data/statistical-gis-boundaries-london/ESRI/London_Borough_Excluding_MHW.shp&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_set_crs</span>(<span class="dv">27700</span>)</a></code></pre></div>
<pre><code>## Reading layer `London_Borough_Excluding_MHW&#39; from data source `C:\Users\ucfnmac\OneDrive - University College London\Teaching\CASA0005repo\prac1_data\statistical-gis-boundaries-london\ESRI\London_Borough_Excluding_MHW.shp&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 33 features and 7 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: 503568.2 ymin: 155850.8 xmax: 561957.5 ymax: 200933.9
## epsg (SRID):    NA
## proj4string:    +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.999601272 +x_0=400000 +y_0=-100000 +datum=OSGB36 +units=m +no_defs</code></pre>
<ol start="27" style="list-style-type: decimal">
<li>Another option is to use the function <code>readOGR()</code> from the <code>rgdal</code> package:</li>
</ol>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" title="1">BoroughMapSP &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="st">&quot;prac1_data/statistical-gis-boundaries-london/ESRI/London_Borough_Excluding_MHW.shp&quot;</span>)</a></code></pre></div>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;C:\Users\ucfnmac\OneDrive - University College London\Teaching\CASA0005repo\prac1_data\statistical-gis-boundaries-london\ESRI\London_Borough_Excluding_MHW.shp&quot;, layer: &quot;London_Borough_Excluding_MHW&quot;
## with 33 features
## It has 7 fields</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" title="1"><span class="co">#create a variable for the EPSG code to reference the proj4string </span></a>
<a class="sourceLine" id="cb147-2" title="2"><span class="co">#(EPSG codes are shorter and easier to remember than the full strings!) </span></a>
<a class="sourceLine" id="cb147-3" title="3"><span class="co">#and store it in a variable...</span></a>
<a class="sourceLine" id="cb147-4" title="4">UKBNG &lt;-<span class="st"> &quot;+init=epsg:27700&quot;</span></a>
<a class="sourceLine" id="cb147-5" title="5"><span class="co">#now set the proj4string for your BoroughMap object</span></a>
<a class="sourceLine" id="cb147-6" title="6"><span class="co">#note, this will probably throw an error if your dataset already has a </span></a>
<a class="sourceLine" id="cb147-7" title="7"><span class="co">#CRS, this is just for demonstration...</span></a>
<a class="sourceLine" id="cb147-8" title="8"><span class="kw">proj4string</span>(BoroughMapSP) &lt;-<span class="st"> </span><span class="kw">CRS</span>(UKBNG)</a></code></pre></div>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" title="1"><span class="kw">print</span>(BoroughMapSP) <span class="co"># check for new CRS</span></a></code></pre></div>
<pre><code>## class       : SpatialPolygonsDataFrame 
## features    : 33 
## extent      : 503568.2, 561957.5, 155850.8, 200933.9  (xmin, xmax, ymin, ymax)
## crs         : +init=epsg:27700 +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +datum=OSGB36 +units=m +no_defs +ellps=airy +towgs84=446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894 
## variables   : 7
## names       :                 NAME,  GSS_CODE,  HECTARES, NONLD_AREA, ONS_INNER, SUB_2009, SUB_2006 
## min values  : Barking and Dagenham, E09000001,   314.942,          0,         F,       NA,       NA 
## max values  :          Westminster, E09000033, 15013.487,    370.619,         T,       NA,       NA</code></pre>
</div>
<div id="reprojecting-your-spatial-data" class="section level4">
<h4><span class="header-section-number">2.5.1.3</span> Reprojecting your spatial data</h4>
<p>Reprojecting your data is something that you might have to (or want to) do, on occasion. Why? Well, one example might be if you want to measure the distance of a line object, or the distance between two polygons. This can be done far more easily in a projected coordinate system like British National Grid (where the units are measured in metres) than it can a geographic coordinate system such as WGS84 (where the units are degrees).</p>
<p>For generating maps in packages like <code>leaflet</code>, your maps will also need to be in WGS84, rather than British National Grid.</p>
<ol start="28" style="list-style-type: decimal">
<li>So once your data has a coordinates system to work with, we can re-project or transform to anything we like. The most commonly used is the global latitude and longitude system (WGS84). With SP objects, this is carried out using the <code>spTransform()</code> function:</li>
</ol>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" title="1">BoroughMapSPWGS84 &lt;-<span class="kw">spTransform</span>(BoroughMapSP, <span class="kw">CRS</span>(<span class="st">&quot;+proj=longlat +datum=WGS84&quot;</span>))</a>
<a class="sourceLine" id="cb150-2" title="2"><span class="kw">print</span>(BoroughMapSPWGS84)</a></code></pre></div>
<pre><code>## class       : SpatialPolygonsDataFrame 
## features    : 33 
## extent      : -0.5103751, 0.3340155, 51.28676, 51.69187  (xmin, xmax, ymin, ymax)
## crs         : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0 
## variables   : 7
## names       :                 NAME,  GSS_CODE,  HECTARES, NONLD_AREA, ONS_INNER, SUB_2009, SUB_2006 
## min values  : Barking and Dagenham, E09000001,   314.942,          0,         F,       NA,       NA 
## max values  :          Westminster, E09000033, 15013.487,    370.619,         T,       NA,       NA</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" title="1"><span class="co">#transform it back again:</span></a>
<a class="sourceLine" id="cb152-2" title="2">BoroughMapSPBNG &lt;-<span class="kw">spTransform</span>(BoroughMapSP, <span class="kw">CRS</span>(UKBNG))</a>
<a class="sourceLine" id="cb152-3" title="3"></a>
<a class="sourceLine" id="cb152-4" title="4"><span class="kw">print</span>(BoroughMapSPBNG)</a></code></pre></div>
<pre><code>## class       : SpatialPolygonsDataFrame 
## features    : 33 
## extent      : 503568.2, 561957.5, 155850.8, 200933.9  (xmin, xmax, ymin, ymax)
## crs         : +init=epsg:27700 +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +datum=OSGB36 +units=m +no_defs +ellps=airy +towgs84=446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894 
## variables   : 7
## names       :                 NAME,  GSS_CODE,  HECTARES, NONLD_AREA, ONS_INNER, SUB_2009, SUB_2006 
## min values  : Barking and Dagenham, E09000001,   314.942,          0,         F,       NA,       NA 
## max values  :          Westminster, E09000033, 15013.487,    370.619,         T,       NA,       NA</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" title="1"><span class="co">#You may want to create a similar variable for WGS84</span></a>
<a class="sourceLine" id="cb154-2" title="2">latlong &lt;-<span class="st"> &quot;+init=epsg:4326&quot;</span></a></code></pre></div>
<p>And for SF objects it’s carried out using <code>st_transform</code>:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" title="1">BoroughMapSFWGS84 &lt;-<span class="st"> </span><span class="kw">st_transform</span>(BoroughMapSF, <span class="dv">4326</span>)</a>
<a class="sourceLine" id="cb155-2" title="2"></a>
<a class="sourceLine" id="cb155-3" title="3"><span class="kw">print</span>(BoroughMapSFWGS84)</a></code></pre></div>
<pre><code>## Simple feature collection with 33 features and 7 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: -0.5103751 ymin: 51.28676 xmax: 0.3340156 ymax: 51.69187
## epsg (SRID):    4326
## proj4string:    +proj=longlat +datum=WGS84 +no_defs
## First 10 features:
##                    NAME  GSS_CODE  HECTARES NONLD_AREA ONS_INNER SUB_2009
## 1  Kingston upon Thames E09000021  3726.117      0.000         F     &lt;NA&gt;
## 2               Croydon E09000008  8649.441      0.000         F     &lt;NA&gt;
## 3               Bromley E09000006 15013.487      0.000         F     &lt;NA&gt;
## 4              Hounslow E09000018  5658.541     60.755         F     &lt;NA&gt;
## 5                Ealing E09000009  5554.428      0.000         F     &lt;NA&gt;
## 6              Havering E09000016 11445.735    210.763         F     &lt;NA&gt;
## 7            Hillingdon E09000017 11570.063      0.000         F     &lt;NA&gt;
## 8                Harrow E09000015  5046.330      0.000         F     &lt;NA&gt;
## 9                 Brent E09000005  4323.270      0.000         F     &lt;NA&gt;
## 10               Barnet E09000003  8674.837      0.000         F     &lt;NA&gt;
##    SUB_2006                       geometry
## 1      &lt;NA&gt; MULTIPOLYGON (((-0.330679 5...
## 2      &lt;NA&gt; MULTIPOLYGON (((-0.0640212 ...
## 3      &lt;NA&gt; MULTIPOLYGON (((0.01213098 ...
## 4      &lt;NA&gt; MULTIPOLYGON (((-0.2445624 ...
## 5      &lt;NA&gt; MULTIPOLYGON (((-0.4118326 ...
## 6      &lt;NA&gt; MULTIPOLYGON (((0.1586929 5...
## 7      &lt;NA&gt; MULTIPOLYGON (((-0.4040719 ...
## 8      &lt;NA&gt; MULTIPOLYGON (((-0.4040719 ...
## 9      &lt;NA&gt; MULTIPOLYGON (((-0.1965687 ...
## 10     &lt;NA&gt; MULTIPOLYGON (((-0.1998964 ...</code></pre>
<p>In the SF object, you can compare the values in the geometry column with those in the original file to look at how they have changed…</p>
</div>
</div>
<div id="maps-with-extra-features" class="section level3">
<h3><span class="header-section-number">2.5.2</span> Maps with extra features</h3>
<p>Now we can re-project our data, it frees us up to bring in, for example, different base maps and other stuff…</p>
<p>How about adding a basemap to our map…this follows on from the earlier section (when i said <code>read_osm()</code> wasn’t working) and builds on what we just learned about mapping with <code>ggplot</code></p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" title="1"><span class="kw">install.packages</span>(<span class="kw">c</span>(<span class="st">&quot;ggmap&quot;</span>, <span class="st">&quot;BAMMtools&quot;</span>))</a></code></pre></div>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" title="1"><span class="kw">library</span>(ggmap)</a>
<a class="sourceLine" id="cb158-2" title="2"><span class="kw">library</span>(BAMMtools)</a>
<a class="sourceLine" id="cb158-3" title="3"></a>
<a class="sourceLine" id="cb158-4" title="4"><span class="co"># put into WGS84 to get basemap data</span></a>
<a class="sourceLine" id="cb158-5" title="5">BoroughDataMapWGS84&lt;-<span class="kw">st_transform</span>(BoroughDataMap, <span class="dv">4326</span>)</a>
<a class="sourceLine" id="cb158-6" title="6"></a>
<a class="sourceLine" id="cb158-7" title="7"><span class="co"># bounding box of London </span></a>
<a class="sourceLine" id="cb158-8" title="8">londonbbox2 &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">st_bbox</span>(BoroughDataMapWGS84))</a>
<a class="sourceLine" id="cb158-9" title="9"></a>
<a class="sourceLine" id="cb158-10" title="10"><span class="co"># use bounding box to get our basemap</span></a>
<a class="sourceLine" id="cb158-11" title="11">b &lt;-<span class="st"> </span><span class="kw">get_map</span>(londonbbox2, </a>
<a class="sourceLine" id="cb158-12" title="12">             <span class="dt">maptype=</span><span class="st">&quot;roadmap&quot;</span>, </a>
<a class="sourceLine" id="cb158-13" title="13">             <span class="dt">source=</span><span class="st">&quot;osm&quot;</span>, </a>
<a class="sourceLine" id="cb158-14" title="14">             <span class="dt">zoom=</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb158-15" title="15"><span class="kw">plot</span>(b)</a></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-142-1.png" width="672" /></p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" title="1"><span class="co"># try changing the maptype to watercolor</span></a>
<a class="sourceLine" id="cb159-2" title="2">b &lt;-<span class="st"> </span><span class="kw">get_stamenmap</span>(londonbbox2,</a>
<a class="sourceLine" id="cb159-3" title="3">                   <span class="dt">zoom =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb159-4" title="4">                   <span class="dt">source=</span><span class="st">&quot;osm&quot;</span>,</a>
<a class="sourceLine" id="cb159-5" title="5">                   <span class="dt">maptype =</span> <span class="st">&quot;toner-lite&quot;</span>)</a>
<a class="sourceLine" id="cb159-6" title="6"><span class="kw">plot</span>(b)</a></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-142-2.png" width="672" /></p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" title="1"><span class="co"># work out the jenks of our data, k means numnber of divisons</span></a>
<a class="sourceLine" id="cb160-2" title="2">jenks=<span class="kw">getJenksBreaks</span>(BoroughDataMapWGS84<span class="op">$</span>Rate.of.JobSeekers.Allowance..JSA..Claimants...<span class="dv">2015</span>,</a>
<a class="sourceLine" id="cb160-3" title="3">                     <span class="dt">k=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb160-4" title="4"></a>
<a class="sourceLine" id="cb160-5" title="5"><span class="co"># set the palette using colorbrewer</span></a>
<a class="sourceLine" id="cb160-6" title="6">palette1&lt;-<span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">type =</span> <span class="st">&quot;seq&quot;</span>, </a>
<a class="sourceLine" id="cb160-7" title="7">                                <span class="dt">palette =</span> <span class="st">&quot;YlOrBr&quot;</span>, </a>
<a class="sourceLine" id="cb160-8" title="8">                                <span class="dt">breaks=</span>jenks, </a>
<a class="sourceLine" id="cb160-9" title="9">                                <span class="dt">guide=</span><span class="st">&quot;legend&quot;</span>)</a>
<a class="sourceLine" id="cb160-10" title="10"><span class="co"># any labels</span></a>
<a class="sourceLine" id="cb160-11" title="11">labels&lt;-<span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Rate per 1,000 people&quot;</span>,</a>
<a class="sourceLine" id="cb160-12" title="12">             <span class="dt">x=</span><span class="st">&quot;Longitude&quot;</span>, </a>
<a class="sourceLine" id="cb160-13" title="13">             <span class="dt">y=</span><span class="st">&quot;Latitude&quot;</span>)</a>
<a class="sourceLine" id="cb160-14" title="14"></a>
<a class="sourceLine" id="cb160-15" title="15"><span class="co"># use the basemap then add our other data</span></a>
<a class="sourceLine" id="cb160-16" title="16">map&lt;-ggmap<span class="op">::</span><span class="kw">ggmap</span>(b) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb160-17" title="17"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> BoroughDataMapWGS84,</a>
<a class="sourceLine" id="cb160-18" title="18">          <span class="kw">aes</span>(<span class="dt">geometry=</span>geometry,</a>
<a class="sourceLine" id="cb160-19" title="19">              <span class="dt">fill=</span>Rate.of.JobSeekers.Allowance..JSA..Claimants...<span class="dv">2015</span>),</a>
<a class="sourceLine" id="cb160-20" title="20">          <span class="dt">alpha=</span><span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb160-21" title="21">          <span class="dt">inherit.aes =</span> <span class="ot">FALSE</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb160-22" title="22"><span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb160-23" title="23"><span class="st">  </span>palette1<span class="op">+</span></a>
<a class="sourceLine" id="cb160-24" title="24"><span class="st">  </span>labels<span class="op">+</span></a>
<a class="sourceLine" id="cb160-25" title="25"><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill=</span><span class="kw">guide_legend</span>(<span class="dt">title=</span><span class="st">&quot;JSA&quot;</span>))</a>
<a class="sourceLine" id="cb160-26" title="26"></a>
<a class="sourceLine" id="cb160-27" title="27"><span class="kw">plot</span>(map)</a></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-142-3.png" width="672" /></p>
</div>
<div id="extension" class="section level3">
<h3><span class="header-section-number">2.5.3</span> Extension</h3>
<div id="faceted-plots" class="section level4">
<h4><span class="header-section-number">2.5.3.1</span> Faceted plots</h4>
<p>One of the nice features of <code>ggplot2</code> is its faceting function which allows you to lay out subsets of your data in different panels of a grid.</p>
<p>See if you can create a faceted grid of London maps like the one shown below. To do this, you will need to go through several stages:</p>
<ol style="list-style-type: decimal">
<li><p>You will might need to subset your data frame so that it only contains data on the same scale (you have a number of columns that counts and area, for example) –– you can show facets on different scales, but we will leave this for the time being (this code is not shown here).</p></li>
<li><p>You will also need to make sure your subset includes a few columns of key ID information data at the beginning –– e.g. ID and geometry.</p></li>
<li><p>You will then need to use the <code>reshape2</code> package to reformat your data using the <code>melt()</code> function, with an argument to specify the columns where your ID data ends (all columns afterwards containing data you want to plot). Use melt to bung all of the variables into a single column on top of each other, but leave out the geometry column or it will throw an error. Make sure you know which coloumn holds the geometry.I’m only going to select 10 coloumns of data here (measure.vars=10:20)…a call something like:</p></li>
</ol>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb161-1" title="1"><span class="co">#warning, this is messy, but it sort-of works...</span></a>
<a class="sourceLine" id="cb161-2" title="2"><span class="kw">library</span>(reshape2)</a>
<a class="sourceLine" id="cb161-3" title="3"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb161-4" title="4"></a>
<a class="sourceLine" id="cb161-5" title="5">borough_melt &lt;-<span class="st"> </span><span class="kw">melt</span>(BoroughDataMap,<span class="dt">id.vars =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>, <span class="dt">measure.vars =</span> <span class="dv">10</span><span class="op">:</span><span class="dv">20</span>)</a></code></pre></div>
<p>Have a look at <code>borough_melt</code> now — in this circumstance i find the best way is to click on the data in the enviroment window (top right), what do you notice?</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" title="1"><span class="co">#now join the geometry column back on </span></a>
<a class="sourceLine" id="cb162-2" title="2"><span class="co">#you will have to join it along with all of the data again.</span></a>
<a class="sourceLine" id="cb162-3" title="3">borough_melt &lt;-<span class="st"> </span><span class="kw">left_join</span>(borough_melt,BoroughDataMap,<span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;GSS_CODE&quot;</span> =<span class="st"> &quot;GSS_CODE&quot;</span>))</a>
<a class="sourceLine" id="cb162-4" title="4"></a>
<a class="sourceLine" id="cb162-5" title="5"><span class="co">#here i&#39;m removing everything except the variable coloumn, </span></a>
<a class="sourceLine" id="cb162-6" title="6"><span class="co">#values and the geometry inforamtion</span></a>
<a class="sourceLine" id="cb162-7" title="7">borough_melt &lt;-<span class="st"> </span>borough_melt[,<span class="kw">c</span>(<span class="dv">10</span><span class="op">:</span><span class="dv">11</span>,<span class="dv">84</span>)]</a>
<a class="sourceLine" id="cb162-8" title="8"></a>
<a class="sourceLine" id="cb162-9" title="9"><span class="kw">library</span>(tmap)</a>
<a class="sourceLine" id="cb162-10" title="10"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb162-11" title="11"><span class="kw">library</span>(maptools)</a>
<a class="sourceLine" id="cb162-12" title="12"></a>
<a class="sourceLine" id="cb162-13" title="13"><span class="kw">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</a>
<a class="sourceLine" id="cb162-14" title="14"></a>
<a class="sourceLine" id="cb162-15" title="15">borough_melt &lt;-<span class="st"> </span><span class="kw">st_as_sf</span>(borough_melt)</a>
<a class="sourceLine" id="cb162-16" title="16"></a>
<a class="sourceLine" id="cb162-17" title="17"><span class="kw">qtm</span>(borough_melt, <span class="dt">fill =</span> <span class="st">&quot;value&quot;</span>, <span class="dt">by =</span> <span class="st">&quot;variable&quot;</span>)</a></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-144-1.png" width="672" /></p>
<p>or, indeed, in ggplot2 like this:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" title="1"><span class="kw">ggplot</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb163-2" title="2"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">geometry=</span>geometry, </a>
<a class="sourceLine" id="cb163-3" title="3">                        <span class="dt">fill=</span>value),</a>
<a class="sourceLine" id="cb163-4" title="4">          <span class="dt">data =</span> borough_melt)<span class="op">+</span></a>
<a class="sourceLine" id="cb163-5" title="5"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>variable)</a></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-145-1.png" width="672" /></p>
</div>
<div id="interactive-web-maps" class="section level4">
<h4><span class="header-section-number">2.5.3.2</span> Interactive web maps</h4>
<p>So we created an interactive map with <code>tmap</code> earlier and that was pretty cool, but if we want to do even more mind-blowing stuff later on in the course, we will need to get our heads around how to do interactive maps using <code>leaflet</code>.</p>
<p>Leaflet is a Java Script library for producing interactive web maps, and some enterprising coders over at RStudio have produced a package for allowing you to create your own Leaflet maps. All of the documentation for the R Leaflet package can be found <a href="https://rstudio.github.io/leaflet/">here</a></p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb164-1" title="1"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb164-2" title="2"><span class="kw">library</span>(sp)</a>
<a class="sourceLine" id="cb164-3" title="3"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb164-4" title="4"><span class="kw">library</span>(classInt)</a>
<a class="sourceLine" id="cb164-5" title="5"><span class="kw">library</span>(htmlTable)</a>
<a class="sourceLine" id="cb164-6" title="6"><span class="kw">library</span>(htmltools)</a>
<a class="sourceLine" id="cb164-7" title="7"><span class="kw">library</span>(htmlwidgets)</a>
<a class="sourceLine" id="cb164-8" title="8"><span class="kw">library</span>(leaflet)</a></code></pre></div>
<div id="generating-a-colour-ramp-and-palette" class="section level5">
<h5><span class="header-section-number">2.5.3.2.1</span> Generating a colour ramp and palette</h5>
<p>Before we create a leaflet map, we need to specify what the breaks in our data are going to be…</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb165-1" title="1">colours&lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(<span class="dv">5</span>, <span class="st">&quot;Blues&quot;</span>)</a>
<a class="sourceLine" id="cb165-2" title="2"></a>
<a class="sourceLine" id="cb165-3" title="3">breaks&lt;-<span class="kw">classIntervals</span>(BoroughDataMap<span class="op">$</span>Claimant.Rate.of.Housing.Benefit..<span class="fl">2015.</span>, </a>
<a class="sourceLine" id="cb165-4" title="4">                       <span class="dt">n=</span><span class="dv">5</span>, </a>
<a class="sourceLine" id="cb165-5" title="5">                       <span class="dt">style=</span><span class="st">&quot;jenks&quot;</span>)</a>
<a class="sourceLine" id="cb165-6" title="6"></a>
<a class="sourceLine" id="cb165-7" title="7">graphics<span class="op">::</span><span class="kw">plot</span>(breaks, </a>
<a class="sourceLine" id="cb165-8" title="8">               <span class="dt">pal=</span>colours)</a></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-146-1.png" width="672" /></p>
<p>So we have now created a breaks object which uses the jenks natural breaks algorithm to divide up our variable into 5 classes. You will notice that breaks is a list of 2 objects. We want only the <code>brks</code> bit which contains the values for the breaks</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb166-1" title="1"><span class="kw">summary</span>(breaks)</a></code></pre></div>
<pre><code>##      Length Class  Mode   
## var  34     -none- numeric
## brks  6     -none- numeric</code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb168-1" title="1">breaks &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(breaks<span class="op">$</span>brks)</a></code></pre></div>
<p>Now we can create out leaflet interactive map.</p>
<p>Here you will see that I am using different syntax to that which has gone before. The %&gt;% (pipe) operator is part of the <code>magrittr</code> <a href="https://cran.r-project.org/web/packages/magrittr/vignettes/magrittr.html">package</a>. <code>magrittr</code> is an entirely new way of thinking about R syntax. Read up on it if you wish, but for now it is useful to think of the pipe operator as simply meaning “then”. Do this THEN do this THEN do that.</p>
</div>
<div id="generating-a-colour-ramp-and-palette-1" class="section level5">
<h5><span class="header-section-number">2.5.3.2.2</span> Generating a colour ramp and palette</h5>
<p>Before we create a leaflet map, we need to specify what the breaks in our data are going to be…</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb169-1" title="1">colours&lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(<span class="dv">5</span>, <span class="st">&quot;Blues&quot;</span>)</a>
<a class="sourceLine" id="cb169-2" title="2"></a>
<a class="sourceLine" id="cb169-3" title="3">breaks&lt;-<span class="kw">classIntervals</span>(BoroughDataMap<span class="op">$</span>Claimant.Rate.of.Housing.Benefit..<span class="fl">2015.</span>, </a>
<a class="sourceLine" id="cb169-4" title="4">                       <span class="dt">n=</span><span class="dv">5</span>, </a>
<a class="sourceLine" id="cb169-5" title="5">                       <span class="dt">style=</span><span class="st">&quot;jenks&quot;</span>)</a>
<a class="sourceLine" id="cb169-6" title="6"></a>
<a class="sourceLine" id="cb169-7" title="7">graphics<span class="op">::</span><span class="kw">plot</span>(breaks, </a>
<a class="sourceLine" id="cb169-8" title="8">               <span class="dt">pal=</span>colours)</a></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-149-1.png" width="672" /></p>
<p>So we have now created a breaks object which uses the jenks natural breaks algorithm to divide up our variable into 5 classes. You will notice that breaks is a list of 2 objects. We want only the <code>brks</code> bit which contains the values for the breaks</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb170-1" title="1"><span class="kw">summary</span>(breaks)</a></code></pre></div>
<pre><code>##      Length Class  Mode   
## var  34     -none- numeric
## brks  6     -none- numeric</code></pre>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb172-1" title="1">breaks &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(breaks<span class="op">$</span>brks)</a></code></pre></div>
<p>Now we can create out leaflet interactive map.</p>
<p>Here you will see that I am using different syntax to that which has gone before. The %&gt;% (pipe) operator is part of the <code>magrittr</code> <a href="https://cran.r-project.org/web/packages/magrittr/vignettes/magrittr.html">package</a>. <code>magrittr</code> is an entirely new way of thinking about R syntax. Read up on it if you wish, but for now it is useful to think of the pipe operator as simply meaning “then”. Do this THEN do this THEN do that.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb173-1" title="1"><span class="co"># now, add some polygons colour them using your colour palette,</span></a>
<a class="sourceLine" id="cb173-2" title="2"><span class="co">#overlay the, on top of a nice backdrop and add a legend. </span></a>
<a class="sourceLine" id="cb173-3" title="3"><span class="co">#Note the use of the magrittr pipe operator (%&gt;%)</span></a>
<a class="sourceLine" id="cb173-4" title="4"><span class="co">#check the documentation to understand how this is working…</span></a>
<a class="sourceLine" id="cb173-5" title="5"></a>
<a class="sourceLine" id="cb173-6" title="6"><span class="co">#create a new sp object from the earlier sf object </span></a>
<a class="sourceLine" id="cb173-7" title="7"><span class="co">#with all of our data in THEN Transform it to WGS84 </span></a>
<a class="sourceLine" id="cb173-8" title="8"><span class="co">#THEN convert it to SP.  </span></a>
<a class="sourceLine" id="cb173-9" title="9"></a>
<a class="sourceLine" id="cb173-10" title="10">BoroughDataMapSP &lt;-<span class="st"> </span>BoroughDataMap <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb173-11" title="11"><span class="st">  </span><span class="kw">st_transform</span>(<span class="dt">crs =</span> <span class="dv">4326</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb173-12" title="12"><span class="st">  </span><span class="kw">as</span>(<span class="st">&quot;Spatial&quot;</span>)</a>
<a class="sourceLine" id="cb173-13" title="13"></a>
<a class="sourceLine" id="cb173-14" title="14"><span class="co">#create a colour palette using colorBin colour mapping</span></a>
<a class="sourceLine" id="cb173-15" title="15">pal &lt;-<span class="st"> </span><span class="kw">colorBin</span>(<span class="dt">palette =</span> <span class="st">&quot;YlOrRd&quot;</span>, </a>
<a class="sourceLine" id="cb173-16" title="16">                <span class="dt">domain =</span> BoroughDataMapSP<span class="op">$</span>Claimant.Rate.of.Housing.Benefit..<span class="fl">2015.</span>,</a>
<a class="sourceLine" id="cb173-17" title="17">                <span class="co">#create bins using the breaks object from earlier</span></a>
<a class="sourceLine" id="cb173-18" title="18">                <span class="dt">bins =</span> breaks)</a>
<a class="sourceLine" id="cb173-19" title="19"></a>
<a class="sourceLine" id="cb173-20" title="20">prac2leaf &lt;-<span class="st"> </span><span class="kw">leaflet</span>(BoroughDataMapSP) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb173-21" title="21"><span class="st">  </span><span class="kw">addPolygons</span>(<span class="dt">stroke =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb173-22" title="22">              <span class="dt">fillOpacity =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb173-23" title="23">              <span class="dt">smoothFactor =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb173-24" title="24">              <span class="dt">color =</span> <span class="op">~</span><span class="kw">pal</span>(Claimant.Rate.of.Housing.Benefit..<span class="fl">2015.</span>),</a>
<a class="sourceLine" id="cb173-25" title="25">              <span class="dt">popup =</span> <span class="op">~</span>NAME</a>
<a class="sourceLine" id="cb173-26" title="26">  )  <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb173-27" title="27"><span class="st">  </span><span class="kw">addProviderTiles</span>(<span class="st">&quot;CartoDB.DarkMatter&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb173-28" title="28"><span class="st">  </span><span class="kw">addLegend</span>(<span class="st">&quot;bottomright&quot;</span>,</a>
<a class="sourceLine" id="cb173-29" title="29">            <span class="dt">pal=</span> pal,</a>
<a class="sourceLine" id="cb173-30" title="30">            <span class="dt">values =</span> <span class="op">~</span>Claimant.Rate.of.Housing.Benefit..<span class="fl">2015.</span>,</a>
<a class="sourceLine" id="cb173-31" title="31">            <span class="dt">title =</span> <span class="st">&quot;Housing Benefit Claimant Rate&quot;</span>,</a>
<a class="sourceLine" id="cb173-32" title="32">            <span class="dt">labFormat =</span> <span class="kw">labelFormat</span>(<span class="dt">prefix =</span> <span class="st">&quot;Per 1,000 people &quot;</span>),</a>
<a class="sourceLine" id="cb173-33" title="33">            <span class="dt">opacity =</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb173-34" title="34">  )</a></code></pre></div>
<iframe src="prac2_data/prac2leaf.html" width="672" height="400px">
</iframe>
</div>
</div>
</div>
</div>
<div id="writing-good-r-code" class="section level2">
<h2><span class="header-section-number">2.6</span> Writing good R code</h2>
<p>There are some basic principles to follow when writing code</p>
<ol style="list-style-type: decimal">
<li>Use descriptive names for variaibles so you know what they are — this can be difficult especailly if you have multiple similar variables.</li>
<li>Comment out parts you don’t need to run using #</li>
<li>Provide regular comments for each part of your code. As you work through this practical book you should be able to find a small description of what each part of the code does. This is good practice as it not only helps you remember what your codes does, when you inevitably forget in the future, but also lets other understand and ‘read’ your code quicker.</li>
<li>Use indents appropriately — this again greatly helps with readability and understanding. For example, what is easier to understand…this..</li>
</ol>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb174-1" title="1">map&lt;-ggmap<span class="op">::</span><span class="kw">ggmap</span>(b) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb174-2" title="2"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> BoroughDataMapWGS84,</a>
<a class="sourceLine" id="cb174-3" title="3">          <span class="kw">aes</span>(<span class="dt">geometry=</span>geometry,</a>
<a class="sourceLine" id="cb174-4" title="4">              <span class="dt">fill=</span>Rate.of.JobSeekers.Allowance..JSA..Claimants...<span class="dv">2015</span>),</a>
<a class="sourceLine" id="cb174-5" title="5">          <span class="dt">alpha=</span><span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb174-6" title="6">          <span class="dt">inherit.aes =</span> <span class="ot">FALSE</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb174-7" title="7"><span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb174-8" title="8"><span class="st">  </span>palette1<span class="op">+</span></a>
<a class="sourceLine" id="cb174-9" title="9"><span class="st">  </span>labels<span class="op">+</span></a>
<a class="sourceLine" id="cb174-10" title="10"><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill=</span><span class="kw">guide_legend</span>(<span class="dt">title=</span><span class="st">&quot;JSA&quot;</span>))</a>
<a class="sourceLine" id="cb174-11" title="11"></a>
<a class="sourceLine" id="cb174-12" title="12"><span class="kw">plot</span>(map)</a></code></pre></div>
<p>or this…</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb175-1" title="1">map&lt;-ggmap<span class="op">::</span><span class="kw">ggmap</span>(b) <span class="op">+</span><span class="st"> </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> BoroughDataMapWGS84,<span class="kw">aes</span>(<span class="dt">geometry=</span>geometry,<span class="dt">fill=</span>Rate.of.JobSeekers.Allowance..JSA..Claimants...<span class="dv">2015</span>),<span class="dt">alpha=</span><span class="fl">0.5</span>,<span class="dt">inherit.aes =</span> <span class="ot">FALSE</span>)<span class="op">+</span><span class="kw">theme_minimal</span>()<span class="op">+</span>palette1<span class="op">+</span>labels<span class="op">+</span><span class="kw">guides</span>(<span class="dt">fill=</span><span class="kw">guide_legend</span>(<span class="dt">title=</span><span class="st">&quot;JSA&quot;</span>))</a>
<a class="sourceLine" id="cb175-2" title="2"></a>
<a class="sourceLine" id="cb175-3" title="3"><span class="kw">plot</span>(map)</a></code></pre></div>
</div>
<div id="tidying-data" class="section level2">
<h2><span class="header-section-number">2.7</span> Tidying data</h2>
<p>In this practical we just showed how you to load, extract and reshape data using <code>melt</code>, however there is a better way to tidy data. As per the <a href="https://r4ds.had.co.nz/tidy-data.html">R for Data Science book</a>, tidy data is defined using the following three rules:</p>
<ol style="list-style-type: decimal">
<li><p>Each variable must have its own column.</p></li>
<li><p>Each observation must have its own row.</p></li>
<li><p>Each value must have its own cell.</p></li>
</ol>
<p>But, as per the book, these three are interrelated as you can’t only adhere to two without adhering to all three. So this gives us:</p>
<ol style="list-style-type: decimal">
<li><p>Put each dataset in a tibble</p></li>
<li><p>Put each variable in a column</p></li>
</ol>
<p>Earlier we read in the data using:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb176-1" title="1">flytipping &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://data.london.gov.uk/download/fly-tipping-incidents/536278ff-a391-4f20-bc79-9e705c9b3ec0/fly-tipping-borough.csv&quot;</span>)</a></code></pre></div>
<p>But we can also do something like this to force the columns to the appopraite data types (e.g. text, numberic)</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb177-1" title="1">flytipping1 &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://data.london.gov.uk/download/fly-tipping-incidents/536278ff-a391-4f20-bc79-9e705c9b3ec0/fly-tipping-borough.csv&quot;</span>, </a>
<a class="sourceLine" id="cb177-2" title="2">                       <span class="dt">col_types =</span> <span class="kw">cols</span>(</a>
<a class="sourceLine" id="cb177-3" title="3">                         <span class="dt">code =</span> <span class="kw">col_character</span>(),</a>
<a class="sourceLine" id="cb177-4" title="4">                         <span class="dt">area =</span> <span class="kw">col_character</span>(),</a>
<a class="sourceLine" id="cb177-5" title="5">                         <span class="dt">year =</span> <span class="kw">col_character</span>(),</a>
<a class="sourceLine" id="cb177-6" title="6">                         <span class="dt">total_incidents =</span> <span class="kw">col_number</span>(),</a>
<a class="sourceLine" id="cb177-7" title="7">                         <span class="dt">total_action_taken =</span> <span class="kw">col_number</span>(),</a>
<a class="sourceLine" id="cb177-8" title="8">                         <span class="dt">warning_letters =</span> <span class="kw">col_number</span>(),</a>
<a class="sourceLine" id="cb177-9" title="9">                         <span class="dt">fixed_penalty_notices =</span> <span class="kw">col_number</span>(),</a>
<a class="sourceLine" id="cb177-10" title="10">                         <span class="dt">statutory_notices =</span> <span class="kw">col_number</span>(),</a>
<a class="sourceLine" id="cb177-11" title="11">                         <span class="dt">formal_cautions =</span> <span class="kw">col_number</span>(),</a>
<a class="sourceLine" id="cb177-12" title="12">                         <span class="dt">injunctions =</span> <span class="kw">col_number</span>(),</a>
<a class="sourceLine" id="cb177-13" title="13">                         <span class="dt">prosecutions =</span> <span class="kw">col_number</span>()</a>
<a class="sourceLine" id="cb177-14" title="14">                       ))</a>
<a class="sourceLine" id="cb177-15" title="15"><span class="co"># view the data</span></a>
<a class="sourceLine" id="cb177-16" title="16"><span class="kw">view</span>(flytipping1)</a></code></pre></div>
<p>So we have a tibble with columns of each varaible (e.g. warning letters, total actions taken) where every row is a London borough. We want make sure that each observation has its own row…it doesn’t as in the first row here we have observations for total incidents and total actions taken etc…to do this we will use <code>pivot_longer()</code>. Make sure you have the most recent version of <code>tidyverse</code> if you get an error.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb178-1" title="1"><span class="co">#convert the tibble into a tidy tibble</span></a>
<a class="sourceLine" id="cb178-2" title="2"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb178-3" title="3">flytipping_long &lt;-<span class="st"> </span>flytipping1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(</a>
<a class="sourceLine" id="cb178-4" title="4">  <span class="dt">cols =</span> <span class="dv">4</span><span class="op">:</span><span class="dv">11</span>,</a>
<a class="sourceLine" id="cb178-5" title="5">  <span class="dt">names_to =</span> <span class="st">&quot;tipping_type&quot;</span>,</a>
<a class="sourceLine" id="cb178-6" title="6">  <span class="dt">values_to =</span> <span class="st">&quot;count&quot;</span></a>
<a class="sourceLine" id="cb178-7" title="7">)</a>
<a class="sourceLine" id="cb178-8" title="8"></a>
<a class="sourceLine" id="cb178-9" title="9"><span class="co"># view the data</span></a>
<a class="sourceLine" id="cb178-10" title="10"><span class="kw">view</span>(flytipping_long)</a></code></pre></div>
<p>Do you see the difference…this is classed as tidy data as every variable has a column, every observation has a row and every value has a cell.</p>
<p>You could also use this to do the same thing…</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb179-1" title="1"><span class="co">#an alternative which just pulls everything out into a single table</span></a>
<a class="sourceLine" id="cb179-2" title="2">flytipping2 &lt;-<span class="st"> </span>flytipping1[,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]</a></code></pre></div>
<p>But my advice would be to learn how to use the tidy tools!</p>
<p>Now let’s make it a bit more suitable for mapping with <code>pivot_wider()</code> by making coloumns for each year of each variable….in the original <code>.csv</code> we had a year coloumn that had values of 2011-2012 to 2017-2018, so if we wanted to map a specifc year we’d have to filter out the year then map. Here we can just alter the data from <code>pivot_longer()</code> using the year and tipping type…</p>
<blockquote>
<p>Note, just because the data is considered tidy doesn’t mean it is directly appropriate for mapping. It might need to be tidy for analysis, such as where we used <code>melt()</code> earlier on (you could replace <code>melt()</code> with what we’ve shown you here) but for mapping you probably want something a bit different.</p>
</blockquote>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb180-1" title="1"><span class="co">#pivot the tidy tibble into one that is suitable for mapping</span></a>
<a class="sourceLine" id="cb180-2" title="2">flytipping_wide &lt;-<span class="st"> </span>flytipping_long <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_wider</span>(</a>
<a class="sourceLine" id="cb180-3" title="3">  <span class="dt">id_cols =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb180-4" title="4">  <span class="dt">names_from =</span> <span class="kw">c</span>(year,tipping_type),</a>
<a class="sourceLine" id="cb180-5" title="5">  <span class="dt">names_sep =</span> <span class="st">&quot;_&quot;</span>,</a>
<a class="sourceLine" id="cb180-6" title="6">  <span class="dt">values_from =</span> count</a>
<a class="sourceLine" id="cb180-7" title="7">)</a>
<a class="sourceLine" id="cb180-8" title="8"></a>
<a class="sourceLine" id="cb180-9" title="9"><span class="kw">view</span>(flytipping_wide)</a></code></pre></div>
<p>But what if you were just interested in a specific varaible and wanted the coloums to be each year of the data…again using <code>pivot_wider()</code></p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb181-1" title="1">widefly &lt;-<span class="st"> </span>flytipping2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_wider</span>(</a>
<a class="sourceLine" id="cb181-2" title="2">  <span class="dt">names_from =</span> year, </a>
<a class="sourceLine" id="cb181-3" title="3">  <span class="dt">values_from =</span> total_incidents)</a></code></pre></div>
<p>You could now join this to the London borough <code>.shp</code> and produce a map…</p>
<p>What’s the take home from this? Basically always try to put your data into a certain format before doing further analysis on it as it will be easier for you to determine the right tools to select.</p>
</div>
<div id="feedback-1" class="section level2">
<h2><span class="header-section-number">2.8</span> Feedback</h2>
<p>Was anything that we explained unclear this week or was something really clear…let us know <a href="https://forms.gle/w2GUDYc7tSavGy7r6">here</a>. It’s anonymous and we’ll use the responses to clear any issues up in the future / adapt the material.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="geographic-information.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="rasters-descriptive-statistics-and-interpolation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/02-prac2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
